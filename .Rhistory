factorial(35)/(factorial(34)*2)
factorial(35)/(factorial(33)*2)
sum(1:34)
hist(same.spp.pairs$Percent.Ident)
hist(nonclade.pairs$Percent.Ident)
View(percent_identical)
View(nonclade.pairs)
nonclade.pairs$Percent.Ident <- as.numeric(nonclade.pairs$Percent.Ident)
hist(nonclade.pairs$Percent.Ident)
hist(same.spp.pairs$Percent.Ident)
hist(nonclade.pairs$Percent.Ident)
hist(same.spp.pairs$Percent.Ident, xlim = c(0,0.5), breaks = 10)
hist(same.spp.pairs$Percent.Ident, xlim = c(0,0.5), breaks = seq(0,0.5, by=0,05))
hist(same.spp.pairs$Percent.Ident, xlim = c(0,0.5), breaks = seq(0,0.5, by=0.05))
hist(nonclade.pairs$Percent.Ident, xlim = c(0,0.5), breaks = seq(0,0.5, by=0.05))
hist(same.spp.pairs$Percent.Ident, xlim = c(0,0.5), breaks = seq(0,0.5, by=0.05), freq = FALSE)
hist(nonclade.pairs$Percent.Ident, xlim = c(0,0.5), breaks = seq(0,0.5, by=0.05), freq = FALSE)
hist(same.spp.pairs$Percent.Ident, xlim = c(0,0.5), breaks = seq(0,0.5, by=0.05), freq = FALSE)
hist(nonclade.pairs$Percent.Ident, xlim = c(0,0.5), breaks = seq(0,0.5, by=0.05), freq = FALSE)
hist(same.spp.pairs$Percent.Ident, xlim = c(0,0.5), breaks = seq(0,0.5, by=0.05), freq = FALSE, ylim = c(0,10))
hist(nonclade.pairs$Percent.Ident, xlim = c(0,0.5), breaks = seq(0,0.5, by=0.05), freq = FALSE, ylim = c(0,10))
hist(nonclade.pairs$Percent.Ident, xlim = c(0,0.5), breaks = seq(0,0.5, by=0.05), freq = FALSE, ylim = c(0,11))
hist(same.spp.pairs$Percent.Ident, xlim = c(0,0.5), breaks = seq(0,0.5, by=0.05), freq = FALSE, ylim = c(0,11))
spp.hist <- hist(same.spp.pairs$Percent.Ident, xlim = c(0,0.5), breaks = seq(0,0.5, by=0.05), freq = FALSE, ylim = c(0,11), plot = FALSE)
spp.hist <- hist(same.spp.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
nonclade.hist <- hist(nonclade.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
c1 <- rgb(173,216,230, max = 244, alpha = 80)
c2 <- rgb(255,192,203, max = 255, alpha = 80)
plot(nonclade.hist, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c1)
plot(spp.hist, add = TRUE, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c2)
c1 <- rgb(255,255,255, max = 244, alpha = 80)
c1 <- rgb(255,255,255, max = 255, alpha = 80)
plot(nonclade.hist, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c1)
plot(spp.hist, add = TRUE, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c2)
c1 <- rgb(0,0,0, max = 255, alpha = 80)
plot(nonclade.hist, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c1)
c2 <- rgb(255,192,203, max = 255, alpha = 0)
plot(nonclade.hist, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c1)
c1 <- rgb(0,0,0, max = 255, alpha = 0)
plot(nonclade.hist, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c1)
c1 <- rgb(0,0,0, max = 255, alpha = 100)
plot(nonclade.hist, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c1)
c1 <- rgb(0,0,0, max = 255, alpha = 100)
c2 <- rgb(0,158,115, max = 255, alpha = 100)
plot(nonclade.hist, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c1)
plot(nonclade.hist, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c1)
plot(spp.hist, add = TRUE, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c2)
c1 <- rgb(0,0,0, max = 255, alpha = 255)
plot(nonclade.hist, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c1)
plot(spp.hist, add = TRUE, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c2)
spp.hist <- hist(same.spp.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
nonclade.hist <- hist(nonclade.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
c1 <- rgb(0,0,0, max = 255, alpha = 200)
c2 <- rgb(213,94,0, max = 255, alpha = 150)
plot(nonclade.hist, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c1)
plot(spp.hist, add = TRUE, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c2)
spp.hist <- hist(same.spp.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
nonclade.hist <- hist(nonclade.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
c1 <- rgb(0,0,0, max = 255, alpha = 200)
c2 <- rgb(213,94,0, max = 255, alpha = 150)
plot(nonclade.hist, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c1, main = "", xlab = "Percent of Idenitcal Sequences")
plot(spp.hist, add = TRUE, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c2)
legent(0.45, 10, legend = c("Same Species", "Different Clades"), fill = c(c2,c1))
spp.hist <- hist(same.spp.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
nonclade.hist <- hist(nonclade.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
c1 <- rgb(0,0,0, max = 255, alpha = 200)
c2 <- rgb(213,94,0, max = 255, alpha = 150)
plot(nonclade.hist, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c1, main = "", xlab = "Percent of Idenitcal Sequences")
plot(spp.hist, add = TRUE, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c2)
legend(0.45, 10, legend = c("Same Species", "Different Clades"), fill = c(c2,c1))
spp.hist <- hist(same.spp.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
nonclade.hist <- hist(nonclade.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
c1 <- rgb(0,0,0, max = 255, alpha = 200)
c2 <- rgb(213,94,0, max = 255, alpha = 150)
plot(nonclade.hist, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c1, main = "", xlab = "Percent of Idenitcal Sequences")
plot(spp.hist, add = TRUE, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c2)
legend(0.3, 11, legend = c("Same Species", "Different Clades"), fill = c(c2,c1))
spp.hist <- hist(same.spp.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
nonclade.hist <- hist(nonclade.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
c1 <- rgb(0,0,0, max = 255, alpha = 200)
c2 <- rgb(213,94,0, max = 255, alpha = 150)
plot(nonclade.hist, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c1, main = "", xlab = "Percent of Idenitcal Sequences")
plot(spp.hist, add = TRUE, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c2)
legend(0.35, 11, legend = c("Same Species", "Different Clades"), fill = c(c2,c1))
spp.hist <- hist(same.spp.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
nonclade.hist <- hist(nonclade.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
c1 <- rgb(0,0,0, max = 255, alpha = 200)
c2 <- rgb(213,94,0, max = 255, alpha = 150)
plot(nonclade.hist, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c1, main = "", xlab = "Percent of Idenitcal Sequences")
plot(spp.hist, add = TRUE, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c2)
legend(0.36, 11, legend = c("Same Species", "Different Clades"), fill = c(c2,c1))
spp.hist <- hist(same.spp.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
nonclade.hist <- hist(nonclade.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
c1 <- rgb(0,0,0, max = 255, alpha = 200)
c2 <- rgb(213,94,0, max = 255, alpha = 150)
plot(nonclade.hist, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c1, main = "", xlab = "Percent of Idenitcal Sequences", ylab = "Proportion")
plot(spp.hist, add = TRUE, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c2)
axis(2, at = seq(0,10, by=2), labels = seq(0,0.1,by=0.02))
legend(0.36, 11, legend = c("Same Species", "Different Clades"), fill = c(c2,c1))
spp.hist <- hist(same.spp.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
nonclade.hist <- hist(nonclade.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
c1 <- rgb(0,0,0, max = 255, alpha = 200)
c2 <- rgb(213,94,0, max = 255, alpha = 150)
plot(nonclade.hist, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c1, main = "", xlab = "Percent of Idenitcal Sequences", ylab = "Proportion")
plot(spp.hist, add = TRUE, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c2)
axis(2, labels = seq(0,0.1,by=0.02))
spp.hist <- hist(same.spp.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
nonclade.hist <- hist(nonclade.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
c1 <- rgb(0,0,0, max = 255, alpha = 200)
c2 <- rgb(213,94,0, max = 255, alpha = 150)
plot(nonclade.hist, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c1, main = "", xlab = "Percent of Idenitcal Sequences", ylab = "Proportion")
plot(spp.hist, add = TRUE, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c2)
axis(2, at = c(0,2,4,6,8,10),labels = seq(0,0.1,by=0.02))
legend(0.36, 11, legend = c("Same Species", "Different Clades"), fill = c(c2,c1))
spp.hist <- hist(same.spp.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
nonclade.hist <- hist(nonclade.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
c1 <- rgb(0,0,0, max = 255, alpha = 200)
c2 <- rgb(213,94,0, max = 255, alpha = 150)
plot(nonclade.hist, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c1, main = "", xlab = "Percent of Idenitcal Sequences", ylab = "Proportion", yaxt = "n")
plot(spp.hist, add = TRUE, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c2)
axis(2, at = c(0,2,4,6,8,10),labels = seq(0,0.1,by=0.02))
legend(0.36, 11, legend = c("Same Species", "Different Clades"), fill = c(c2,c1))
spp.hist <- hist(same.spp.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
nonclade.hist <- hist(nonclade.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
c1 <- rgb(0,0,0, max = 255, alpha = 200)
c2 <- rgb(213,94,0, max = 255, alpha = 150)
plot(nonclade.hist, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c1, main = "", xlab = "Percent of Idenitcal Sequences", ylab = "Proportion", yaxt = "n", xaxt = "n")
plot(spp.hist, add = TRUE, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c2)
axis(2, at = c(0,2,4,6,8,10),labels = seq(0,0.1,by=0.02))
axis(1, at = seq(0,0.5, by = 0.1),labels = c("0%","10%","20%","30%","40%","50%"))
legend(0.36, 11, legend = c("Same Species", "Different Clades"), fill = c(c2,c1))
spp.hist <- hist(same.spp.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
nonclade.hist <- hist(nonclade.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
c1 <- rgb(0,0,0, max = 255, alpha = 200)
c2 <- rgb(213,94,0, max = 255, alpha = 150)
plot(nonclade.hist, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c1, main = "", xlab = "Percent of Idenitcal Sequences", ylab = "Proportion of Total", yaxt = "n", xaxt = "n")
plot(spp.hist, add = TRUE, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c2)
axis(2, at = c(0,2,4,6,8,10),labels = seq(0,0.1,by=0.02))
axis(1, at = seq(0,0.5, by = 0.1),labels = c("0%","10%","20%","30%","40%","50%"))
legend(0.36, 11, legend = c("Same Species", "Different Clades"), fill = c(c2,c1))
library(vcfR)
library(stringr)
setwd("~/Documents/GitHub/jg-exon-capture/12_bowtie/")
source("vcf-parse-function.R")
vcf.names <- readLines("all_recoded_vcfs_list.txt")
vcf.names.noM <- vcf.names[-44]
vcf.onlyM <- vcf.names[44]
hist1.list <- list()
hist2.list <- list()
hist3.list <- list()
hist4.list <- list()
hist5.list <- list()
hist6.list <- list()
hist7.list <- list()
avg.tot.depth <- c()
avg.filt.depth <- c()
percent.sites.removed <- c()
filt.SNP.num <- c()
Gene.per.indivi <- c()
for(i in 1:length(vcf.names.noM)){
save.name <- str_sub(vcf.names.noM[i], 1, nchar(vcf.names.noM[i])-12)
my.vcf <- vcf.parser(vcf.names.noM[i])
hist1.list[[i]] <- my.vcf[[1]]
hist2.list[[i]] <- my.vcf[[2]]
hist3.list[[i]] <- my.vcf[[3]]
hist4.list[[i]] <- my.vcf[[4]]
hist5.list[[i]] <- my.vcf[[5]]
hist6.list[[i]] <- my.vcf[[6]]
hist7.list[[i]] <- my.vcf[[7]]
avg.tot.depth[i] <- mean(my.vcf[[8]]$Depth)
avg.filt.depth[i] <- mean(my.vcf[[9]]$Depth)
percent.sites.removed[i] <- length(which(my.vcf[[8]]$Depth <= 20))/length(my.vcf[[8]]$Depth)
filt.SNP.num[i] <- length(my.vcf[[9]]$Depth)
Gene.per.indivi[i] <- nrow(my.vcf[[10]])
assign(save.name, my.vcf)
}
my.vcf[[8]]
dp.ad.list <- list()
for(i in 1:length(vcf.names.noM)){
save.name <- str_sub(vcf.names.noM[i], 1, nchar(vcf.names.noM[i])-12)
my.vcf <- vcf.parser(vcf.names.noM[i])
hist1.list[[i]] <- my.vcf[[1]]
hist2.list[[i]] <- my.vcf[[2]]
hist3.list[[i]] <- my.vcf[[3]]
hist4.list[[i]] <- my.vcf[[4]]
hist5.list[[i]] <- my.vcf[[5]]
hist6.list[[i]] <- my.vcf[[6]]
hist7.list[[i]] <- my.vcf[[7]]
dp.ad.list[[i]] <- my.vcf[[8]]
avg.tot.depth[i] <- mean(my.vcf[[8]]$Depth)
avg.filt.depth[i] <- mean(my.vcf[[9]]$Depth)
percent.sites.removed[i] <- length(which(my.vcf[[8]]$Depth <= 20))/length(my.vcf[[8]]$Depth)
filt.SNP.num[i] <- length(my.vcf[[9]]$Depth)
Gene.per.indivi[i] <- nrow(my.vcf[[10]])
assign(save.name, my.vcf)
}
head(dp.ad.list)
bind_rows(dp.ad.list, .id = "Depth")
test1 <- as.data.frame(matrix(data=1:4, nrow =2, ncol = 2))
test1
test2 <- as.data.frame(matrix(data=20:23, nrow =2, ncol = 2))
test2
listA <- list(test1,test2)
listA
bind_rows(listA, .id = "V1")
bind_cols(listA, .id = "V1")
bind_cols(listA)
do.call("rbind", listA)
all.depth <- do.call("rbind", dp.ad.list)
AOPE_UW159762_S478
AOPE_UW159762_S478[[8]]
lengths <- c()
for(i in 1:length(vcf.names.noM)){
save.name <- str_sub(vcf.names.noM[i], 1, nchar(vcf.names.noM[i])-12)
my.vcf <- vcf.parser(vcf.names.noM[i])
hist1.list[[i]] <- my.vcf[[1]]
hist2.list[[i]] <- my.vcf[[2]]
hist3.list[[i]] <- my.vcf[[3]]
hist4.list[[i]] <- my.vcf[[4]]
hist5.list[[i]] <- my.vcf[[5]]
hist6.list[[i]] <- my.vcf[[6]]
hist7.list[[i]] <- my.vcf[[7]]
dp.ad.list[[i]] <- my.vcf[[8]]
lengths[i] <- length(my.vcf[[8]]$Depth)
avg.tot.depth[i] <- mean(my.vcf[[8]]$Depth)
avg.filt.depth[i] <- mean(my.vcf[[9]]$Depth)
percent.sites.removed[i] <- length(which(my.vcf[[8]]$Depth <= 20))/length(my.vcf[[8]]$Depth)
filt.SNP.num[i] <- length(my.vcf[[9]]$Depth)
Gene.per.indivi[i] <- nrow(my.vcf[[10]])
assign(save.name, my.vcf)
}
sum(lengths)
View(all.depth)
lengths[1]
spec.names <- c()
indiv.names <- c()
for(i in 1:length(vcf.names.noM)){
save.name <- str_sub(vcf.names.noM[i], 1, nchar(vcf.names.noM[i])-12)
my.vcf <- vcf.parser(vcf.names.noM[i])
hist1.list[[i]] <- my.vcf[[1]]
hist2.list[[i]] <- my.vcf[[2]]
hist3.list[[i]] <- my.vcf[[3]]
hist4.list[[i]] <- my.vcf[[4]]
hist5.list[[i]] <- my.vcf[[5]]
hist6.list[[i]] <- my.vcf[[6]]
hist7.list[[i]] <- my.vcf[[7]]
dp.ad.list[[i]] <- my.vcf[[8]]
lengths[i] <- length(my.vcf[[8]]$Depth)
avg.tot.depth[i] <- mean(my.vcf[[8]]$Depth)
avg.filt.depth[i] <- mean(my.vcf[[9]]$Depth)
percent.sites.removed[i] <- length(which(my.vcf[[8]]$Depth <= 20))/length(my.vcf[[8]]$Depth)
filt.SNP.num[i] <- length(my.vcf[[9]]$Depth)
Gene.per.indivi[i] <- nrow(my.vcf[[10]])
indiv.names[i] <- save.name
assign(save.name, my.vcf)
}
length(lengths)
length(indiv.names)
names.column <- c()
j <- 2
lengths[j]
name.to.paste <- indiv.names[j]
name.reps <- rep(name.to.paste, lengths[j])
names.column <- c()
for(j in 1:length(indiv.names)){
name.to.paste <- indiv.names[j]
name.reps <- rep(name.to.paste, lengths[j])
names.column <- c(names.column,name.reps)
}
length(all.depth$Depth)
all.depth$Spec.Name <- names.column
View(all.depth)
mean(as.numeric(avg.tot.depth))
mean(all.depth$Depth)
length(which(all.depth$Depth <= 20))
length(which(all.depth$Depth <= 20))/length(all.depth$Depth)
mean(as.numeric(avg.filt.depth))
mean(as.numeric(percent.sites.removed))
length(all.depth$Depth)-length(which(all.depth$Depth <= 20))
for(i in 1:length(vcf.names.noM)){
save.name <- str_sub(vcf.names.noM[i], 1, nchar(vcf.names.noM[i])-12)
indiv.names[i] <- save.name
my.vcf <- vcf.parser(vcf.names.noM[i])
hist1.list[[i]] <- my.vcf[[1]]
hist2.list[[i]] <- my.vcf[[2]]
hist3.list[[i]] <- my.vcf[[3]]
hist4.list[[i]] <- my.vcf[[4]]
hist5.list[[i]] <- my.vcf[[5]]
hist6.list[[i]] <- my.vcf[[6]]
hist7.list[[i]] <- my.vcf[[7]]
dp.ad.list[[i]] <- my.vcf[[8]]
lengths[i] <- length(my.vcf[[8]]$Depth)
dp.filt.list[[i]] <- my.vcf[[9]]
#avg.filt.depth[i] <- mean(my.vcf[[9]]$Depth)
#percent.sites.removed[i] <- length(which(my.vcf[[8]]$Depth <= 20))/length(my.vcf[[8]]$Depth)
filt.SNP.num[i] <- length(my.vcf[[9]]$Depth)
Gene.per.indivi[i] <- nrow(my.vcf[[10]])
assign(save.name, my.vcf)
}
dp.filt.list[[i]] <- my.vcf[[9]]
dp.filt.list <- list()
for(i in 1:length(vcf.names.noM)){
save.name <- str_sub(vcf.names.noM[i], 1, nchar(vcf.names.noM[i])-12)
indiv.names[i] <- save.name
my.vcf <- vcf.parser(vcf.names.noM[i])
hist1.list[[i]] <- my.vcf[[1]]
hist2.list[[i]] <- my.vcf[[2]]
hist3.list[[i]] <- my.vcf[[3]]
hist4.list[[i]] <- my.vcf[[4]]
hist5.list[[i]] <- my.vcf[[5]]
hist6.list[[i]] <- my.vcf[[6]]
hist7.list[[i]] <- my.vcf[[7]]
dp.ad.list[[i]] <- my.vcf[[8]]
lengths[i] <- length(my.vcf[[8]]$Depth)
dp.filt.list[[i]] <- my.vcf[[9]]
#avg.filt.depth[i] <- mean(my.vcf[[9]]$Depth)
#percent.sites.removed[i] <- length(which(my.vcf[[8]]$Depth <= 20))/length(my.vcf[[8]]$Depth)
filt.SNP.num[i] <- length(my.vcf[[9]]$Depth)
Gene.per.indivi[i] <- nrow(my.vcf[[10]])
assign(save.name, my.vcf)
}
all.depth <- do.call("rbind", dp.ad.list)
all.filt <- do.call("rbind", dp.filt.list)
View(all.filt)
length(filt.SNP.num)
names.filt <- c()
for(k in 1:length(indiv.names)){
name.to.paste <- indiv.names[k]
name.reps <- rep(name.to.paste, filt.SNP.num[k])
names.filt <- c(names.filt,name.reps)
}
all.filt$Spec.Name <- names.filt
sum(filt.SNP.num[1:2])
mean(all.depth$Depth) #total mean depth
length(which(all.depth$Depth <= 20))/length(all.depth$Depth)
mean(all.filt$Depth)
mean(as.numeric(avg.filt.depth))
mean(as.numeric(filt.SNP.num))
mean(as.numeric(Gene.per.indivi))
write.csv(all.depth, "All_Dp_AD_combined.csv")
write.csv(all.filt, "All_Dp_AD_filtered.csv")
all.depth.read <- read.csv("../12_bowtie/All_Dp_AD_combined.csv")
View(all.depth.read)
for(i in 1:length(vcf.names.noM)){
save.name <- str_sub(vcf.names.noM[i], 1, nchar(vcf.names.noM[i])-12)
indiv.names[i] <- save.name
my.vcf <- vcf.parser(vcf.names.noM[i])
hist1.list[[i]] <- my.vcf[[1]]
hist2.list[[i]] <- my.vcf[[2]]
hist3.list[[i]] <- my.vcf[[3]]
hist4.list[[i]] <- my.vcf[[4]]
hist5.list[[i]] <- my.vcf[[5]]
hist6.list[[i]] <- my.vcf[[6]]
hist7.list[[i]] <- my.vcf[[7]]
dp.ad.list[[i]] <- my.vcf[[8]]
lengths[i] <- length(my.vcf[[8]]$Depth)
dp.filt.list[[i]] <- my.vcf[[9]]
filt.SNP.num[i] <- length(my.vcf[[9]]$Depth)
Gene.per.indivi[i] <- nrow(my.vcf[[10]])
assign(save.name, my.vcf)
}
all.depth <- do.call("rbind", dp.ad.list)
all.filt <- do.call("rbind", dp.filt.list)
names.column <- c()
for(j in 1:length(indiv.names)){
name.to.paste <- indiv.names[j]
name.reps <- rep(name.to.paste, lengths[j])
names.column <- c(names.column,name.reps)
}
all.depth$Spec.Name <- names.column
names.filt <- c()
for(k in 1:length(indiv.names)){
name.to.paste <- indiv.names[k]
name.reps <- rep(name.to.paste, filt.SNP.num[k])
names.filt <- c(names.filt,name.reps)
}
all.filt$Spec.Name <- names.filt
write.csv(all.depth, "All_Dp_AD_combined.csv")
write.csv(all.filt, "All_Dp_AD_filtered.csv")
all.depth.read <- read.csv("../12_bowtie/All_Dp_AD_combined.csv")
View(all.depth.read)
identical_sequences <- read.csv("Identical_Sequences.csv", row.names = 1)
total_sequences <- read.csv("Total_Sequences.csv", row.names = 1)
percent_identical <- identical_sequences/total_sequences
same.spp.pairs <- read.csv("same_spp_names.csv")
same.spp.pairs$Percent.Ident <- NA
for (i in 1:length(same.spp.pairs$COLUMN)){
column <- same.spp.pairs[i,1]
row <- same.spp.pairs[i,2]
same.spp.pairs[i,3] <- percent_identical[row,column]
}
names.with.groups <- read.csv("percent_ident_groups.csv")
nonclade.names <- names.with.groups %>% filter(OutGroup=="yes") %>% pull(Name)
nonclade.pairs <- as.data.frame(matrix(nrow = 0, ncol = 3, data = NA))
colnames(nonclade.pairs) <- c("COLUMN","ROW","Percent.Ident")
for(j in 1:length(nonclade.names)){
column <- nonclade.names[j]
for(k in 1:(length(nonclade.names)-j)){
row.spp <- nonclade.names[j+1:length(nonclade.names)]
row <- row.spp[k]
percent.ident <- percent_identical[row,column]
rowdat <- c(column, row, percent.ident)
nonclade.pairs <- rbind(nonclade.pairs, rowdat)
}
}
colnames(nonclade.pairs) <- c("COLUMN","ROW","Percent.Ident")
nonclade.pairs <- nonclade.pairs[1:595,]
nonclade.pairs$Percent.Ident <- as.numeric(nonclade.pairs$Percent.Ident)
spp.hist <- hist(same.spp.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
nonclade.hist <- hist(nonclade.pairs$Percent.Ident, breaks = seq(0,0.5, by=0.05), plot = FALSE)
c1 <- rgb(0,0,0, max = 255, alpha = 200)
c2 <- rgb(213,94,0, max = 255, alpha = 150)
plot(nonclade.hist, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c1, main = "", xlab = "Percent of Idenitcal Sequences", ylab = "Proportion of Total", yaxt = "n", xaxt = "n")
plot(spp.hist, add = TRUE, xlim = c(0,0.5), ylim = c(0,11), freq = FALSE, col = c2)
axis(2, at = c(0,2,4,6,8,10),labels = seq(0,0.1,by=0.02))
axis(1, at = seq(0,0.5, by = 0.1),labels = c("0%","10%","20%","30%","40%","50%"))
legend(0.36, 11, legend = c("Same Species", "Different Clades"), fill = c(c2,c1))
all.depth.read <- read.csv("../12_bowtie/All_Dp_AD_combined.csv")
all.filt <- read.csv("../12_bowtie/All_Dp_AD_filtered.csv")
all.depth <- read.csv("../12_bowtie/All_Dp_AD_combined.csv")
hist(all.depth$Depth)
hist(all.depth$Depth)
abline(x=20)
abline(h=20)
hist(all.depth$Depth)
abline(h=20)
hist(all.depth$Depth)
abline(h=20, col = "red", lwd = 2)
hist(all.depth$Depth)
abline(v=20, col = "red", lwd = 2)
hist(all.filt$MA_Freq)
hist(all.filt$MA_Freq, main="", xlab = "Minor Allele Frequency")
hist(all.depth$Depth, main = "", xlab = "Read Depth for each SNP")
abline(v=20, col = "red", lwd = 2)
hist(all.depth$Depth, main = "", xlab = "Read Depth for each SNP")
abline(v=20, col = "red", lwd = 2)
hist(all.depth$Depth, main = "", xlab = "Read Depth for each SNP", xlim = c(0,350), ylim = c(0,40500))
hist(all.depth$Depth, main = "", xlab = "Read Depth for each SNP", xlim = c(0,325), ylim = c(0,41000))
hist(all.depth$Depth, main = "", xlab = "Read Depth for each SNP", xlim = c(0,325), ylim = c(0,45000))
hist(all.depth$Depth, main = "", xlab = "Read Depth for each SNP", xlim = c(0,325), ylim = c(0,50000))
abline(v=20, col = "red", lwd = 2)
abline(v=0.48)
hist(all.filt$MA_Freq, main="", xlab = "Minor Allele Frequency")
abline(v=0.48)
hist(all.filt$MA_Freq, main="", xlab = "Minor Allele Frequency")
abline(v=0.06)
hist(all.filt$MA_Freq, main="", xlab = "Minor Allele Frequency")
abline(v=0.04)
hist(all.filt$MA_Freq, main="", xlab = "Minor Allele Frequency")
plot(all.depth$Depth~all.depth$Minor_Allele)
plot(all.depth$Depth~all.depth$MA_Freq)
library(ggtree)
install.packages("ggtree")
install.packages("BiocManager")
library(BiocManager)
BiocManager::install("ggtree")
library(ggtree)
?ggtree
read.tree(file = "../../../../Desktop/primates.tre")
library(tidyverse)
library(ape)
library(rstatix)
library(ggtree)
read.tree(file = "../../../../Desktop/primates.tre")
read.tree(file = "../../../../Desktop/primates.tre", node.label = TRUE)
nwk <- system.file("extdata", "sample.nwk", package="ggtree")
tree <- read.tree(nwk)
tree <- rtree(20)
ggtree(tree)
read.nexus("../../../../Desktop/primates.tre")
primate<-read.nexus("../../../../Desktop/primates.tre")
ggtree(primate)
ggtree(primate) + geom_tiplab()
primate
primate.root <- root(primate, outgroup = "Lemur_catta")
ggtree(primate.root) + geom_tiplab()
primate.root
class(primate[[1]])
class(primate[[2]])
class(primate[[3]])
class(primate[[4]])
class(primate[[5]])
primate.root <- root(primate, outgroup = "Lemur_catta")
is.rooted(primate)
is.rooted(primate.root)
primate.root <- root(primate, 2)
is.rooted(primate.root)
primate$tip.label
primate$tip.label[2]
class(primate)
primate.root <- root(primate, 2)
ggtree(primate.root) + geom_tiplab()
primate.root <- root(primate, 3)
ggtree(primate.root) + geom_tiplab()
primate.root <- root(primate, 2)
ggtree(primate.root) + geom_tiplab()
is.rooted(primate.root)
class(primate.root)
primate.root <- root(primate, 3)
primate.root <- root(primate, 3)
is.rooted(primate.root)
primate.root
primate.root <- root(primate, 2, resolve.root = TRUE)
is.rooted(primate.root)
ggtree(primate.root) + geom_tiplab()
p1 <- ggtree(primate.root) + geom_tiplab()
p1
primate.root$tip.label
viewClade(p1, MRCA(p1, tip = c("M_sylvanus","M_mulatta")))
MRCA(p1, .node1 = "Msylvanus", .node2 = "M_mulatta")
library(phytools)
install.packages("phytools")
