axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 filtered SNPs"), line = 2.5, tick = FALSE)
par(mfrow = c(2,1))
hist(bimod.trunc, xlim = c(0,0.5), breaks = 10, main = "", xlab = "")
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 hypothetical "), line = 2.5, tick = FALSE)
text(x = -0.05, y = 30000, labels = "A")
hist(all.filt$MA_Freq, main="", xlab = "")
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 filtered SNPs"), line = 2.5, tick = FALSE)
par(mfrow = c(2,1))
hist(bimod.trunc, xlim = c(0,0.5), breaks = 10, main = "", xlab = "")
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 hypothetical "), line = 2.5, tick = FALSE)
text(x = 0, y = 20000, labels = "A")
hist(all.filt$MA_Freq, main="", xlab = "")
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 filtered SNPs"), line = 2.5, tick = FALSE)
par(mfrow = c(2,1))
hist(bimod.trunc, xlim = c(0,0.5), breaks = 10, main = "", xlab = "")
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 hypothetical "), line = 2.5, tick = FALSE)
text(x = -0.05, y = 25000, labels = "A", cex = 3)
hist(all.filt$MA_Freq, main="", xlab = "")
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 filtered SNPs"), line = 2.5, tick = FALSE)
par(mfrow = c(2,1))
hist(bimod.trunc, xlim = c(0,0.5), breaks = 10, main = "", xlab = "")
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 hypothetical "), line = 2.5, tick = FALSE)
text(x = -0.05, y = 20000, labels = "A", cex = 3)
hist(all.filt$MA_Freq, main="", xlab = "")
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 filtered SNPs"), line = 2.5, tick = FALSE)
par(mfrow = c(2,1))
hist(bimod.trunc, xlim = c(0,0.5), breaks = 10, main = "", xlab = "")
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 hypothetical "), line = 2.5, tick = FALSE)
text(x = -0.01, y = 20000, labels = "A", cex = 3)
hist(all.filt$MA_Freq, main="", xlab = "")
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 filtered SNPs"), line = 2.5, tick = FALSE)
par(mfrow = c(2,1))
hist(bimod.trunc, xlim = c(0,0.5), breaks = 10, main = "", xlab = "")
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 hypothetical "), line = 2.5, tick = FALSE)
mtext("A", outer = TRUE, cex = 2)
hist(all.filt$MA_Freq, main="", xlab = "")
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 filtered SNPs"), line = 2.5, tick = FALSE)
par(mfrow = c(2,1))
hist(bimod.trunc, xlim = c(0,0.5), breaks = 10, main = "", xlab = "")
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 hypothetical "), line = 2.5, tick = FALSE)
mtext("A", outer = TRUE, cex = 2, side = 3)
hist(all.filt$MA_Freq, main="", xlab = "")
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 filtered SNPs"), line = 2.5, tick = FALSE)
#dev.off()
tiff(filename = "../../../../Desktop/MA_freq_hist.tiff", width = 7, height = 8.5, units = "in", res = 300)
par(mfrow = c(2,1))
hist(bimod.trunc, xlim = c(0,0.5), breaks = 10, main = "", xlab = "")
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 hypothetical "), line = 2.5, tick = FALSE)
hist(all.filt$MA_Freq, main="", xlab = "")
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 filtered SNPs"), line = 2.5, tick = FALSE)
dev.off()
tiff(filename = "../../../../Desktop/MA_freq_hist.tiff", width = 7, height = 8.5, units = "in", res = 300)
par(mfrow = c(2,1))
hist(bimod.trunc, xlim = c(0,0.5), breaks = 10, main = "", xlab = "")
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 hypothetical loci"), line = 2.5, tick = FALSE)
hist(all.filt$MA_Freq, main="", xlab = "")
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 filtered SNPs"), line = 2.5, tick = FALSE)
dev.off()
bimod.trunc <- c(rtruncnorm(30602, a = 0, b = Inf, mean = 0, sd = 0.01), rtruncnorm(30602, a = -Inf, b = 0.5, mean = 0.5, sd = 0.01))
#par(mfrow = c(2,1))
hist(bimod.trunc, xlim = c(0,0.5), breaks = 10, main = "", xlab = "")
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 hypothetical "), line = 2.5, tick = FALSE)
hist(bimod.trunc, xlim = c(0,0.5), breaks = 20, main = "", xlab = "")
par(mfrow = c(2,1))
hist(bimod.trunc, xlim = c(0,0.5), breaks = 20, main = "", xlab = "")
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 hypothetical "), line = 2.5, tick = FALSE)
hist(all.filt$MA_Freq, main="", xlab = "", breaks = 20)
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 filtered SNPs"), line = 2.5, tick = FALSE)
all.seq.filt <- all.filt %>% filter(MA_Freq < 0.01)
par(mfrow = c(2,1))
hist(bimod.trunc, xlim = c(0,0.5), breaks = 20, main = "", xlab = "")
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 hypothetical "), line = 2.5, tick = FALSE)
hist(all.seq.filt$MA_Freq, main="", xlab = "", breaks = 20)
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 filtered SNPs"), line = 2.5, tick = FALSE)
ist(all.seq.filt$MA_Freq, main="", xlab = "", breaks = 20)
hist(all.seq.filt$MA_Freq, main="", xlab = "", breaks = 20)
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 filtered SNPs"), line = 2.5, tick = FALSE)
all.seq.filt <- all.filt %>% filter(MA_Freq > 0.01)
hist(all.seq.filt$MA_Freq, main="", xlab = "", breaks = 20)
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 filtered SNPs"), line = 2.5, tick = FALSE)
par(mfrow = c(2,1))
hist(bimod.trunc, xlim = c(0,0.5), breaks = 20, main = "", xlab = "")
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 hypothetical "), line = 2.5, tick = FALSE)
hist(all.seq.filt$MA_Freq, main="", xlab = "", breaks = 20)
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 filtered SNPs"), line = 2.5, tick = FALSE)
bimod.trunc <- c(rtruncnorm(30602, a = -Inf, b = 0.5, mean = 0.5, sd = 0.01))
par(mfrow = c(2,1))
hist(bimod.trunc, xlim = c(0,0.5), breaks = 20, main = "", xlab = "")
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 hypothetical "), line = 2.5, tick = FALSE)
hist(all.seq.filt$MA_Freq, main="", xlab = "", breaks = 20)
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 filtered SNPs"), line = 2.5, tick = FALSE)
par(mfrow = c(2,1))
hist(bimod.trunc, xlim = c(0,0.5), breaks = 2, main = "", xlab = "")
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 hypothetical "), line = 2.5, tick = FALSE)
hist(all.seq.filt$MA_Freq, main="", xlab = "", breaks = 20)
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 filtered SNPs"), line = 2.5, tick = FALSE)
hist(all.seq.filt$MA_Freq, main="", xlab = "", breaks = 20)
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 filtered SNPs"), line = 2.5, tick = FALSE)
library(tidyverse)
library(ape)
library(rstatix)
library(phytools)
library(mgcv)
library(truncnorm)
run2 <- read.tree(file = "../4_Run_2/9_RAxML_orn_rm_bl/RAxML_bootstrap.9_orn_bl")
run2.consensus <- consensus(run2, p = 0.5, check.labels = TRUE, rooted = FALSE)
run2.consensus.bl <- consensus.edges(run2)
plotTree(run2.consensus)
plotTree(run2.consensus.bl)
write.tree(run2.consensus.bl, file = "TreeFigures/Run2_consensus.tree", digits = 20)
run6 <- read.tree(file = "../9_Run_6/28_RAxML_r6_bl/RAxML_bootstrap.28_r6_bl")
run6.consensus <- consensus(run6, p = 0.5, check.labels = TRUE, rooted = FALSE)
run6.consensus.bl <- consensus.edges(run6)
plotTree(run6.consensus)
plotTree(run6.consensus.bl)
write.tree(run6.consensus.bl, file = "TreeFigures/Run6_consensus.tree", digits = 20)
rungene <- read.tree(file = "../10_Gene_Trees/32_RAxML_full_bl/RAxML_bootstrap.32_full_bl")
rungene.consensus <- consensus(rungene, p = 0.5, check.labels = TRUE, rooted = FALSE)
rungene.consensus.bl <- consensus.edges(rungene)
plotTree(rungene.consensus)
plotTree(rungene.consensus.bl)
write.tree(rungene.consensus.bl, file = "TreeFigures/Rungene_consensus.tree", digits = 20)
run.da <- read.tree(file = "../0_da_test/Da_Tree/RAxML_bootstrap.DA_tree2_bl")
run.da.consensus.bl <- consensus.edges(run.da)
plotTree(run.da.consensus.bl)
write.tree(run.da.consensus.bl, file = "TreeFigures/Run.da_consensus.tree", digits = 20)
run.da <- read.tree(file = "../0_da_test/Da_Tree/RAxML_bootstrap.DA_tree2_bl")
run.da.consensus.bl <- consensus.edges(run.da)
plotTree(run.da.consensus.bl)
write.tree(run.da.consensus.bl, file = "TreeFigures/Runda_consensus.tree", digits = 20)
citation
citation()
my.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/PLEQUAD_UW151438_S22_results.vcf")
vcf.parser <- function(vcf.name) {
my.vcf <- read.vcfR(paste("all_recoded_vcfs/",vcf.name, sep = ""), verbose = FALSE)
ID.name <- str_sub(vcf.name, 1, nchar(vcf.name)-12)
dp <- extract.gt(my.vcf, element = "DP", as.numeric = TRUE)
ad <- extract.gt(my.vcf, element = "AD")
ad.allele1 <- masplit(ad, sort = 0, record = 1)
ad.allele2 <- masplit(ad, sort = 0, record = 2)
dp.ad.tbl <- as.data.frame(cbind(dp, ad.allele1, ad.allele2))
colnames(dp.ad.tbl) <- c("Depth", "A1_Count", "A2_Count")
dp.ad.tbl$Minor_Allele <- ifelse(dp.ad.tbl$A1_Count > dp.ad.tbl$A2_Count, dp.ad.tbl$A2_Count,
ifelse(dp.ad.tbl$A1_Count < dp.ad.tbl$A2_Count, dp.ad.tbl$A1_Count, dp.ad.tbl$A2_Count))
dp.ad.tbl$Third_Allele <- dp.ad.tbl$Depth - (dp.ad.tbl$A1_Count + dp.ad.tbl$A2_Count)
dp.ad.tbl$MA_Freq <- dp.ad.tbl$Minor_Allele/dp.ad.tbl$Depth
dp.ad.tbl$TA_Freq <- dp.ad.tbl$Third_Allele/dp.ad.tbl$Depth
n <- length(dp.ad.tbl$Depth)
depth.hist.gg <- ggplot(dp.ad.tbl, aes(x = Depth)) + geom_histogram(binwidth = 20, fill = "grey50", color = "white") +
ggtitle(paste(ID.name, ". Total reads =",n)) +
xlab("Raw Depths before filtering")
dp.ad.filt1 <- dp.ad.tbl %>% filter(Depth > 20)
if(length(dp.ad.filt1$Depth)>1){
ma.filt1.hist.gg <- ggplot(dp.ad.filt1, aes(x = MA_Freq)) + geom_histogram(binwidth = 0.05, fill = "grey50", color = "white") +
ggtitle(paste(ID.name)) + xlim(0, 0.5) +
xlab("Minor Allele Frequency after depth filter")
ta.filt1.hist.gg <- ggplot(dp.ad.filt1, aes(x = TA_Freq)) + geom_histogram(binwidth = 0.01, fill = "grey50", color = "white") +
ggtitle(paste(ID.name)) + xlim(0,0.5) +
xlab("Third Allele Frequency after depth filter")
tbl.filt2 <- dp.ad.filt1 %>% filter(MA_Freq > 0.1)
n.filt2 <- length(tbl.filt2$Depth)
ma.filt2.hist.gg <- ggplot(tbl.filt2, aes(x = MA_Freq)) + geom_histogram(binwidth = 0.05, fill = "grey50", color = "white") +
ggtitle(paste(ID.name, "from", n.filt2, "snps", sep = " ")) + xlim(0, 0.5) +
xlab("Minor Allele Frequency after depth and MA freq filter")
tbl.filt2$Locus <- rownames(tbl.filt2)
tbl.filt2$Locus <- sub('\\.fas.*', '', tbl.filt2$Locus)
tbl.by.loc <- tbl.filt2 %>% group_by(Locus) %>% summarize(n = n(), mean(Depth), mean(MA_Freq), mean(TA_Freq))
n.loc <- length(tbl.by.loc$Locus)
depth.filt2.hist.gg <- ggplot(tbl.by.loc, aes(x = `mean(Depth)`)) + geom_histogram(binwidth = 20, fill = "grey50", color = "white") +
ggtitle(paste(ID.name, "with", n.loc, "genes")) +
xlab("Average Depth")
MAfreq.filt2.hist.gg <- ggplot(tbl.by.loc, aes(x = `mean(MA_Freq)`)) + geom_histogram(binwidth = 0.05, fill = "grey50", color = "white") +
ggtitle(paste(ID.name, "with", n.loc, "genes")) + xlim(0, 0.5) +
xlab("Minor Allele Frequency")
TAfreq.filt2.hist.gg <- ggplot(tbl.by.loc, aes(x = `mean(TA_Freq)`)) + geom_histogram(binwidth = 0.01, fill = "grey50", color = "white") +
ggtitle(paste(ID.name, "with", n.loc, "genes")) + xlim(0,0.5) +
xlab("Third Allele Frequency")
output.data <- list(depth.hist.gg, ma.filt1.hist.gg, ta.filt1.hist.gg, depth.filt2.hist.gg, MAfreq.filt2.hist.gg, TAfreq.filt2.hist.gg,
ma.filt2.hist.gg, dp.ad.tbl, dp.ad.filt1, tbl.by.loc)
} else {
dp.filt1.result <- paste(ID.name, "had no reads with depth >20")
output.data <- list(dp.ad.tbl, depth.hist.gg, dp.filt1.result)
}
return(output.data)
}
my.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/PLEQUAD_UW151438_S22_results.vcf")
library(tidyverse)
library(ape)
library(rstatix)
library(phytools)
library(mgcv)
library(truncnorm)
library(vcfR)
my.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/PLEQUAD_UW151438_S22_results.vcf")
my.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/PLEQUAD_UW151438_S22_results.vcf")
my.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/ACANADU_UW118829_S45_results.vcf")
library(tidyverse)
library(stringr)
source("vcf-parse-function.R")
source("../12_bowtie/vcf-parse-function.R")
my.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/PLEQUAD_UW151438_S22_results.vcf")
source("../12_bowtie/vcf-parse-function.R")
source("../12_bowtie/vcf-parse-function.R")
my.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/PLEQUAD_UW151438_S22_results.vcf")
plequad.filt1 <- my.vcf[[2]]
View(plequad.filt1)
plequad.filt1 <- my.vcf[[9]]
View(plequad.filt1)
plequad.filt2 <- plequad.filt1 %>% filter(MA_Freq >0.01)
hist(plequad.filt2$MA_Freq)
View(plequad.filt2)
plequad.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/PLEQUAD_UW151438_S22_results.vcf")
plequad.filt1 <- plequad.vcf[[9]]
plequad.filt2 <- plequad.filt1 %>% filter(MA_Freq >0.01)
hist(plequad.filt2$MA_Freq)
acandu.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/ACANADU_UW118829_S45_results.vcf")
acandu.filt1 <- plequad.vcf[[9]]
acandu.filt2 <- plequad.filt1 %>% filter(MA_Freq >0.01)
hist(acandu.filt2$MA_Freq)
psemela.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/PSEMELA_UW154235_S57_results.vcf")
psemela.filt1 <- plequad.vcf[[9]]
psemela.filt2 <- plequad.filt1 %>% filter(MA_Freq >0.01)
hist(psemela.filt2$MA_Freq)
plequad.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/PLEQUAD_UW151438_S22_results.vcf")
plequad.filt1 <- plequad.vcf[[9]]
plequad.filt2 <- plequad.filt1 %>% filter(MA_Freq >0.01)
hist(plequad.filt2$MA_Freq)
acandu.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/ACANADU_UW118829_S45_results.vcf")
acandu.filt1 <- acandu.vcf[[9]]
acandu.filt2 <- acandu.filt1 %>% filter(MA_Freq >0.01)
hist(acandu.filt2$MA_Freq)
psemela.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/PSEMELA_UW154235_S57_results.vcf")
psemela.filt1 <- psemela.vcf[[9]]
psemela.filt2 <- psemela.filt1 %>% filter(MA_Freq >0.01)
hist(psemela.filt2$MA_Freq)
all.seq.filt2 <- all.filt %>% filter(MA_Freq > 0.10)
plequad.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/PLEQUAD_UW151438_S22_results.vcf")
plequad.filt1 <- plequad.vcf[[9]]
plequad.filt2 <- plequad.filt1 %>% filter(MA_Freq >0.01)
hist(plequad.filt2$MA_Freq)
acandu.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/ACANADU_UW118829_S45_results.vcf")
acandu.filt1 <- acandu.vcf[[9]]
acandu.filt2 <- acandu.filt1 %>% filter(MA_Freq >0.01)
hist(acandu.filt2$MA_Freq)
psemela.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/PSEMELA_UW154235_S57_results.vcf")
psemela.filt1 <- psemela.vcf[[9]]
psemela.filt2 <- psemela.filt1 %>% filter(MA_Freq >0.01)
hist(psemela.filt2$MA_Freq)
hist(all.seq.filt$MA_Freq)
hist(all.seq.filt2$MA_Freq)
plequad.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/PLEQUAD_UW151438_S22_results.vcf")
plequad.filt1 <- plequad.vcf[[9]]
plequad.filt2 <- plequad.filt1 %>% filter(MA_Freq >0.01)
hist(plequad.filt2$MA_Freq)
acandu.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/ACANADU_UW118829_S45_results.vcf")
acandu.filt1 <- acandu.vcf[[9]]
acandu.filt2 <- acandu.filt1 %>% filter(MA_Freq >0.01)
hist(acandu.filt2$MA_Freq)
psemela.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/PSEMELA_UW154235_S57_results.vcf")
psemela.filt1 <- psemela.vcf[[9]]
psemela.filt2 <- psemela.filt1 %>% filter(MA_Freq >0.01)
hist(psemela.filt2$MA_Freq)
hist(all.seq.filt$MA_Freq)
hist(all.seq.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10)
all.depth <- read.csv("../12_bowtie/All_Dp_AD_combined.csv")
all.filt <- read.csv("../12_bowtie/All_Dp_AD_filtered.csv")
all.seq.filt <- all.filt %>% filter(MA_Freq > 0.01)
all.seq.filt2 <- all.filt %>% filter(MA_Freq > 0.05)
plequad.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/PLEQUAD_UW151438_S22_results.vcf")
plequad.filt1 <- plequad.vcf[[9]]
plequad.filt2 <- plequad.filt1 %>% filter(MA_Freq >0.05)
hist(plequad.filt2$MA_Freq)
acandu.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/ACANADU_UW118829_S45_results.vcf")
acandu.filt1 <- acandu.vcf[[9]]
acandu.filt2 <- acandu.filt1 %>% filter(MA_Freq >0.05)
hist(acandu.filt2$MA_Freq)
psemela.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/PSEMELA_UW154235_S57_results.vcf")
psemela.filt1 <- psemela.vcf[[9]]
psemela.filt2 <- psemela.filt1 %>% filter(MA_Freq >0.05)
hist(psemela.filt2$MA_Freq)
hist(all.seq.filt$MA_Freq)
hist(all.seq.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10)
plequad.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/PLEQUAD_UW151438_S22_results.vcf")
plequad.filt1 <- plequad.vcf[[9]]
plequad.filt2 <- plequad.filt1 %>% filter(MA_Freq >0.05)
acandu.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/ACANADU_UW118829_S45_results.vcf")
acandu.filt1 <- acandu.vcf[[9]]
acandu.filt2 <- acandu.filt1 %>% filter(MA_Freq >0.05)
psemela.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/PSEMELA_UW154235_S57_results.vcf")
psemela.filt1 <- psemela.vcf[[9]]
psemela.filt2 <- psemela.filt1 %>% filter(MA_Freq >0.05)
par(mfrow=c(3,2))
hist(psemela.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10)
hist(acandu.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10)
hist(plequad.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10)
hist(all.seq.filt$MA_Freq, xlim = c(0,0.5), breaks = 10)
hist(all.seq.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10)
plequad.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/PLEQUAD_UW151438_S22_results.vcf")
plequad.filt1 <- plequad.vcf[[9]]
plequad.filt2 <- plequad.filt1 %>% filter(MA_Freq >0.05)
acandu.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/ACANADU_UW118829_S45_results.vcf")
acandu.filt1 <- acandu.vcf[[9]]
acandu.filt2 <- acandu.filt1 %>% filter(MA_Freq >0.05)
psemela.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/PSEMELA_UW154235_S57_results.vcf")
psemela.filt1 <- psemela.vcf[[9]]
psemela.filt2 <- psemela.filt1 %>% filter(MA_Freq >0.05)
par(mfrow=c(3,2))
hist(psemela.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10)
hist(acandu.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10)
hist(plequad.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10)
hist(all.seq.filt$MA_Freq, xlim = c(0,0.5), breaks = 10)
hist(all.seq.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10)
plequad.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/PLEQUAD_UW151438_S22_results.vcf")
plequad.filt1 <- plequad.vcf[[9]]
plequad.filt2 <- plequad.filt1 %>% filter(MA_Freq >0.05)
acandu.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/ACANADU_UW118829_S45_results.vcf")
acandu.filt1 <- acandu.vcf[[9]]
acandu.filt2 <- acandu.filt1 %>% filter(MA_Freq >0.05)
psemela.vcf <- vcf.parser("../12_bowtie/test5_calder/all_recoded_vcfs/PSEMELA_UW154235_S57_results.vcf")
psemela.filt1 <- psemela.vcf[[9]]
psemela.filt2 <- psemela.filt1 %>% filter(MA_Freq >0.05)
par(mfrow=c(2,3))
hist(psemela.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10)
hist(acandu.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10)
hist(plequad.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10)
hist(all.seq.filt$MA_Freq, xlim = c(0,0.5), breaks = 10)
hist(all.seq.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10)
tiff(filename = "../../../../Desktop/Depth_MAfreq.tiff", width = 7, height = 5, units = "in", res = 300)
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) +
geom_point(colour = "grey80") +
theme_classic() +
geom_smooth(formula = y ~ poly(x,2), colour = "black") +
labs(x = "Minor Allele Frequency at Heterozygous Sites", y = "Read Depth") +
theme(axis.title.x = element_text(size=14, face="bold"),axis.title.y = element_text(size=14, face="bold"),
axis.text=element_text(size=12, colour = "black")) +
geom_text(x=0.48, y=320, label=expression(r^2 == 0.03))
dev.off()
#tiff(filename = "../../../../Desktop/MA_freq_hist.tiff", width = 7, height = 8.5, units = "in", res = 300)
par(mfrow = c(2,1))
hist(plequad.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10, main = "", xlab = "")
axis(1, at = 0.25, labels = c("Minor Allele Frequency at Heterozygous Sites"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 762 filtered SNPs"), line = 2.5, tick = FALSE)
hist(all.seq.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10, main="", xlab = "")
axis(1, at = 0.25, labels = c("Minor Allele Frequency at Heterozygous Sites"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 28807 filtered SNPs"), line = 2.5, tick = FALSE)
#dev.off()
#tiff(filename = "../../../../Desktop/MA_freq_hist.tiff", width = 7, height = 8.5, units = "in", res = 300)
par(mfrow = c(2,1))
hist(plequad.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10, main = "", xlab = "", density = TRUE)
axis(1, at = 0.25, labels = c("Minor Allele Frequency at Heterozygous Sites"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 762 filtered SNPs"), line = 2.5, tick = FALSE)
hist(all.seq.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10, main="", xlab = "", density = TRUE)
axis(1, at = 0.25, labels = c("Minor Allele Frequency at Heterozygous Sites"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 28807 filtered SNPs"), line = 2.5, tick = FALSE)
#dev.off()
#tiff(filename = "../../../../Desktop/MA_freq_hist.tiff", width = 7, height = 8.5, units = "in", res = 300)
par(mfrow = c(2,1))
hist(plequad.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10, main = "", xlab = "", freq = FALSE)
axis(1, at = 0.25, labels = c("Minor Allele Frequency at Heterozygous Sites"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 762 filtered SNPs"), line = 2.5, tick = FALSE)
hist(all.seq.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10, main="", xlab = "", freq = FALSE)
axis(1, at = 0.25, labels = c("Minor Allele Frequency at Heterozygous Sites"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 28807 filtered SNPs"), line = 2.5, tick = FALSE)
#dev.off()
#tiff(filename = "../../../../Desktop/MA_freq_hist.tiff", width = 7, height = 8.5, units = "in", res = 300)
par(mfrow = c(2,1))
hist(plequad.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10, main = "", xlab = "", freq = FALSE, ylab = "")
axis(1, at = 0.25, labels = c("Minor Allele Frequency at Heterozygous Sites"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 762 filtered SNPs"), line = 2.5, tick = FALSE)
axis(2, at = seq(0,4, by =1), labels = 0:4)
hist(all.seq.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10, main="", xlab = "", freq = FALSE, ylab = "")
axis(1, at = 0.25, labels = c("Minor Allele Frequency at Heterozygous Sites"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 28807 filtered SNPs"), line = 2.5, tick = FALSE)
#dev.off()
#tiff(filename = "../../../../Desktop/MA_freq_hist.tiff", width = 7, height = 8.5, units = "in", res = 300)
par(mfrow = c(2,1))
hist(plequad.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10, main = "", xlab = "", freq = FALSE, ylab = "")
axis(1, at = 0.25, labels = c("Minor Allele Frequency at Heterozygous Sites"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 762 filtered SNPs"), line = 2.5, tick = FALSE)
axis(2, at = seq(0,4, by =1), labels = c("0%", "10%", "20%", "30%","40%"))
hist(all.seq.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10, main="", xlab = "", freq = FALSE, ylab = "")
axis(1, at = 0.25, labels = c("Minor Allele Frequency at Heterozygous Sites"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 28807 filtered SNPs"), line = 2.5, tick = FALSE)
#dev.off()
#tiff(filename = "../../../../Desktop/MA_freq_hist.tiff", width = 7, height = 8.5, units = "in", res = 300)
par(mfrow = c(2,1))
hist(plequad.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10, main = "", xlab = "", freq = FALSE, ylab = "", yaxt = "n")
axis(1, at = 0.25, labels = c("Minor Allele Frequency at Heterozygous Sites"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 762 filtered SNPs"), line = 2.5, tick = FALSE)
axis(2, at = seq(0,4, by =1), labels = c("0%", "10%", "20%", "30%","40%"))
hist(all.seq.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10, main="", xlab = "", freq = FALSE, ylab = "")
axis(1, at = 0.25, labels = c("Minor Allele Frequency at Heterozygous Sites"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 28807 filtered SNPs"), line = 2.5, tick = FALSE)
#dev.off()
#tiff(filename = "../../../../Desktop/MA_freq_hist.tiff", width = 7, height = 8.5, units = "in", res = 300)
par(mfrow = c(2,1))
hist(plequad.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10, main = "", xlab = "", freq = FALSE, ylab = "", yaxt = "n")
axis(1, at = 0.25, labels = c("Minor Allele Frequency at Heterozygous Sites"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 762 filtered SNPs"), line = 2.5, tick = FALSE)
axis(2, at = seq(0,4, by =1), labels = c("0%", "10%", "20%", "30%","40%"))
axis(2, at = 2, labels = "Percentage of Sites", line = 2)
hist(all.seq.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10, main="", xlab = "", freq = FALSE, ylab = "")
axis(1, at = 0.25, labels = c("Minor Allele Frequency at Heterozygous Sites"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 28807 filtered SNPs"), line = 2.5, tick = FALSE)
#dev.off()
#tiff(filename = "../../../../Desktop/MA_freq_hist.tiff", width = 7, height = 8.5, units = "in", res = 300)
par(mfrow = c(2,1))
hist(plequad.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10, main = "", xlab = "", freq = FALSE, ylab = "", yaxt = "n")
axis(1, at = 0.25, labels = c("Minor Allele Frequency at Heterozygous Sites"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 762 filtered SNPs"), line = 2.5, tick = FALSE)
axis(2, at = seq(0,4, by =1), labels = c("0%", "10%", "20%", "30%","40%"))
axis(2, at = 2, labels = "Percentage of Sites", line = 2)
hist(all.seq.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10, main="", xlab = "", freq = FALSE, ylab = "", yaxt = "n")
axis(1, at = 0.25, labels = c("Minor Allele Frequency at Heterozygous Sites"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 28807 filtered SNPs"), line = 2.5, tick = FALSE)
axis(2, at = seq(0,4, by =1), labels = c("0%", "10%", "20%", "30%","40%"))
axis(2, at = 2, labels = "Percentage of Sites", line = 2)
#dev.off()
#tiff(filename = "../../../../Desktop/MA_freq_hist.tiff", width = 7, height = 8.5, units = "in", res = 300)
par(mfrow = c(2,1))
hist(plequad.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10, main = "", xlab = "", freq = FALSE, ylab = "", yaxt = "n")
axis(1, at = 0.25, labels = c("Minor Allele Frequency at Heterozygous Sites"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 762 filtered SNPs"), line = 2.5, tick = FALSE)
axis(2, at = seq(0,4, by =1), labels = c("0%", "10%", "20%", "30%","40%"))
axis(2, at = 2, labels = "Percentage of Sites", line = 1.5)
hist(all.seq.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10, main="", xlab = "", freq = FALSE, ylab = "", yaxt = "n")
axis(1, at = 0.25, labels = c("Minor Allele Frequency at Heterozygous Sites"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 28807 filtered SNPs"), line = 2.5, tick = FALSE)
axis(2, at = seq(0,4, by =1), labels = c("0%", "10%", "20%", "30%","40%"))
axis(2, at = 2, labels = "Percentage of Sites", line = 1.5)
#dev.off()
#tiff(filename = "../../../../Desktop/MA_freq_hist.tiff", width = 7, height = 8.5, units = "in", res = 300)
par(mfrow = c(2,1))
hist(plequad.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10, main = "", xlab = "", freq = FALSE, ylab = "", yaxt = "n")
axis(1, at = 0.25, labels = c("Minor Allele Frequency at Heterozygous Sites"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 762 filtered SNPs"), line = 2.5, tick = FALSE)
axis(2, at = seq(0,4, by =1), labels = c("0%", "10%", "20%", "30%","40%"))
axis(2, at = 2, labels = "Percentage of Sites", line = 1.5, tick = FALSE)
hist(all.seq.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10, main="", xlab = "", freq = FALSE, ylab = "", yaxt = "n")
axis(1, at = 0.25, labels = c("Minor Allele Frequency at Heterozygous Sites"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 28807 filtered SNPs"), line = 2.5, tick = FALSE)
axis(2, at = seq(0,4, by =1), labels = c("0%", "10%", "20%", "30%","40%"))
axis(2, at = 2, labels = "Percentage of Sites", line = 1.5)
#dev.off()
#tiff(filename = "../../../../Desktop/MA_freq_hist.tiff", width = 7, height = 8.5, units = "in", res = 300)
par(mfrow = c(2,1))
hist(plequad.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10, main = "", xlab = "", freq = FALSE, ylab = "", yaxt = "n")
axis(1, at = 0.25, labels = c("Minor Allele Frequency at Heterozygous Sites"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 762 filtered SNPs"), line = 2.5, tick = FALSE)
axis(2, at = seq(0,4, by =1), labels = c("0%", "10%", "20%", "30%","40%"))
axis(2, at = 2, labels = "Percentage of Sites", line = 1.5, tick = FALSE)
hist(all.seq.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10, main="", xlab = "", freq = FALSE, ylab = "", yaxt = "n")
axis(1, at = 0.25, labels = c("Minor Allele Frequency at Heterozygous Sites"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 28807 filtered SNPs"), line = 2.5, tick = FALSE)
axis(2, at = seq(0,4, by =1), labels = c("0%", "10%", "20%", "30%","40%"))
axis(2, at = 2, labels = "Percentage of Sites", line = 1.5, tick = FALSE)
#dev.off()
tiff(filename = "../../../../Desktop/MA_freq_hist.tiff", width = 7, height = 8.5, units = "in", res = 300)
par(mfrow = c(2,1))
hist(plequad.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10, main = "", xlab = "", freq = FALSE, ylab = "", yaxt = "n")
axis(1, at = 0.25, labels = c("Minor Allele Frequency at Heterozygous Sites"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 762 filtered SNPs"), line = 2.5, tick = FALSE)
axis(2, at = seq(0,4, by =1), labels = c("0%", "10%", "20%", "30%","40%"))
axis(2, at = 2, labels = "Percentage of Sites", line = 1.5, tick = FALSE)
hist(all.seq.filt2$MA_Freq, xlim = c(0,0.5), breaks = 10, main="", xlab = "", freq = FALSE, ylab = "", yaxt = "n")
axis(1, at = 0.25, labels = c("Minor Allele Frequency at Heterozygous Sites"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 28807 filtered SNPs"), line = 2.5, tick = FALSE)
axis(2, at = seq(0,4, by =1), labels = c("0%", "10%", "20%", "30%","40%"))
axis(2, at = 2, labels = "Percentage of Sites", line = 1.5, tick = FALSE)
dev.off()
all.depth <- read.csv("../12_bowtie/All_Dp_AD_combined.csv")
all.filt <- read.csv("../12_bowtie/All_Dp_AD_filtered.csv")
all.seq.filt <- all.filt %>% filter(MA_Freq > 0.01)
library(tidyverse)
all.seq.filt2 <- all.filt %>% filter(MA_Freq > 0.05)
mean(all.filt2$MA_Freq)
mean(all.seq.filt2$MA_Freq)
sd(all.seq.filt2$MA_Freq) #
mean(all.seq.filt2$MA_Freq) #0.24
