all.pairs <- as.data.frame(matrix(nrow = 0, ncol = 3, data = NA))
colnames(all.pairs) <- c("COLUMN","ROW","Percent.Ident")
for(i in 1:length(all.lip.samples)){
column <- all.lip.samples[i,1]
for(j in 1:(length(all.lip.samples)-i)){
row.spp <- all.lip.samples[i+1:length(all.lip.samples),1]
row <- row.spp[j,1]
percent.ident <- percent_identical[row,column]
rowdat <- c(column, row, percent.ident)
all.pairs <- rbind(all.pairs, rowdat)
}
}
i+1:length(all.lip.samples)
length(all.lip.samples
)
all.lip.samples <- as.vector(all.lip.samples$V1)
length(all.lip.samples)
i+1:length(all.lip.samples)
i <- 6
i+1:length(all.lip.samples)
row.start <- i+1
row.start:length(all.lip.samples)
all.lip.samples <- read.csv("Identical_Sequences_files/all_lip_samples.csv", header = FALSE)
all.lip.samples <- as.vector(all.lip.samples$V1)
all.pairs <- as.data.frame(matrix(nrow = 0, ncol = 3, data = NA))
colnames(all.pairs) <- c("COLUMN","ROW","Percent.Ident")
for(i in 1:length(all.lip.samples)){
column <- all.lip.samples[i]
for(j in 1:(length(all.lip.samples)-i)){
row.start <- i+1
row.spp <- all.lip.samples[row.start:length(all.lip.samples)]
row <- row.spp[j]
percent.ident <- percent_identical[row,column]
rowdat <- c(column, row, percent.ident)
all.pairs <- rbind(all.pairs, rowdat)
}
}
colnames(all.pairs) <- c("COLUMN","ROW","Percent.Ident")
#nonclade.pairs <- nonclade.pairs[1:595,]
all.pairs$Percent.Ident <- as.numeric(all.pairs$Percent.Ident)
View(all.pairs)
all.lip.samples <- read.csv("Identical_Sequences_files/all_lip_samples.csv", header = FALSE)
all.lip.samples <- as.vector(all.lip.samples$V1)
all.pairs <- as.data.frame(matrix(nrow = 0, ncol = 3, data = NA))
colnames(all.pairs) <- c("COLUMN","ROW","Percent.Ident")
for(i in 1:length(all.lip.samples)){
column <- all.lip.samples[i]
for(j in 1:(length(all.lip.samples)-i)){
row.start <- i+1
row.spp <- all.lip.samples[row.start:length(all.lip.samples)]
row <- row.spp[j]
percent.ident <- percent_identical[row,column]
rowdat <- c(column, row, percent.ident)
all.pairs <- rbind(all.pairs, rowdat)
}
}
colnames(all.pairs) <- c("COLUMN","ROW","Percent.Ident")
all.pairs <- all.pairs[1:4465,]
all.pairs$Percent.Ident <- as.numeric(all.pairs$Percent.Ident)
all.same.clade <- read.csv("Identical_Sequences_files/same_clade_all.csv", header = FALSE)
colnames(all.same.clade) <- c("COLUMN","ROW")
View(all.same.clade)
anti_join(all.pairs, all.same.clade, by= c("COLUMN","ROW"))
nonclade.pairs <- anti_join(all.pairs, all.same.clade, by= c("COLUMN","ROW"))
same.clade.pairs <- read.csv("Identical_Sequences_files/same_clade_pairs.csv", header = FALSE)
same.spp.pairs <- read.csv("Identical_Sequences_files/same_spp_pairs.csv", header - FALSE)
same.spp.pairs <- read.csv("Identical_Sequences_files/same_spp_pairs.csv", header = FALSE)
colnames(same.clade.pairs) <- c("COLUMN","ROW")
colnames(same.spp.pairs) <- c("COLUMN","ROW")
clade.pairs <- join(all.pairs, same.clade.pairs,  by = c("COLUMN","ROW"))
clade.pairs <- inner_join(all.pairs, same.clade.pairs,  by = c("COLUMN","ROW"))
View(clade.pairs)
spp.pairs <- inner_join(all.pairs, same.spp.pairs,  by = c("COLUMN","ROW"))
boxplot(spp.pairs$Percent.Ident, clade.pairs$Percent.Ident, nonclade.pairs$Percent.Ident)
boxplot(spp.pairs$Percent.Ident, clade.pairs$Percent.Ident, nonclade.pairs$Percent.Ident, ylab = "Percent of Idenitcal Sequences",
yaxt = "n", xaxt = "n")
axis(2, at = seq(0,0.5, by = 0.1),labels = c("0%","10%","20%","30%","40%","50%"))
boxplot(spp.pairs$Percent.Ident, clade.pairs$Percent.Ident, nonclade.pairs$Percent.Ident, ylab = "Percent of Idenitcal Sequences",
yaxt = "n", xaxt = "n", ylim = c(0, 0.51))
axis(2, at = seq(0,0.5, by = 0.1),labels = c("0%","10%","20%","30%","40%","50%"))
boxplot(spp.pairs$Percent.Ident, clade.pairs$Percent.Ident, nonclade.pairs$Percent.Ident, ylab = "Percent of Idenitcal Sequences",
yaxt = "n", xaxt = "n", ylim = c(0, 0.51))
axis(2, at = seq(0,0.5, by = 0.1),labels = c("0%","10%","20%","30%","40%","50%"))
axis(1, at = c(1,2,3),labels = c("Same Species","Same Clade","Different Clades"))
ggplot(all.filt, aes(x=MA_Freq, y=Depth) + geom_smooth(method = lm)
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_smooth(method = lm)
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_smooth(method = lm, level=0.99)
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_smooth()
summary(lm(all.filt$Depth~all.filt$MA_Freq))
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_smooth()
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_smooth(formula = y ~ poly(x,2))
lm.poly <- lm(all.filt$Depth~poly(all.filt$MA_Freq,2))
plot(all.filt$Depth~all.filt$MA_Freq)
lm.line <- lm(all.filt$Depth~all.filt$MA_Freq)
lm.poly <- lm(all.filt$Depth~poly(all.filt$MA_Freq,2))
summary(lm.line)
summary(lm.poly)
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_smooth(formula = y ~ poly(x,2))
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_smooth(method = lm)
?mgcv
library(mgcv)
gam(all.filt$Depth~all.filt$MA_Freq)
summary(gam(all.filt$Depth~all.filt$MA_Freq))
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_smooth()
summary(gam(all.filt$Depth~s(all.filt$MA_Freq, bs = "cs")))
summary(lm.line)
summary(lm.poly) #r2 =
summary(gam(all.filt$Depth~s(all.filt$MA_Freq, bs = "cs"))) #r2 = 0.05
summary(lm(all.filt$Depth~all.filt$MA_Freq)) #r2 = 0.02
summary(lm(all.filt$Depth~poly(all.filt$MA_Freq,2))) #r2 = 0.03
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_point()
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_smooth(method = lm)
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_smooth(formula = y ~ poly(x,2))
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_smooth()
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_point() + geom_smooth(method = lm, colour = "red")
summary(gam(all.filt$Depth~s(all.filt$MA_Freq, bs = "cs"))) #r2 = 0.05
summary(lm(all.filt$Depth~all.filt$MA_Freq)) #r2 = 0.02
summary(lm(all.filt$Depth~poly(all.filt$MA_Freq,2))) #r2 = 0.03
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_point()
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_smooth(method = lm)
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_smooth(formula = y ~ poly(x,2))
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_smooth()
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_point() + geom_smooth(method = lm, colour = "red")+
geom_smooth(formula = y ~ poly(x,2), colour = "blue") + geom_smooth(colour = "purple")
summary(gam(all.filt$Depth~s(all.filt$MA_Freq, bs = "cs"))) #r2 = 0.05
summary(lm(all.filt$Depth~all.filt$MA_Freq)) #r2 = 0.02
summary(lm(all.filt$Depth~poly(all.filt$MA_Freq,2))) #r2 = 0.03
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_point()
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_smooth(method = lm)
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_smooth(formula = y ~ poly(x,2))
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_smooth()
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_point() + geom_smooth(method = lm, colour = "grey50")+
geom_smooth(formula = y ~ poly(x,2), colour = "blue") + geom_smooth(colour = "orange")
summary(gam(all.filt$Depth~s(all.filt$MA_Freq, bs = "cs"))) #r2 = 0.05
summary(lm(all.filt$Depth~all.filt$MA_Freq)) #r2 = 0.02
summary(lm(all.filt$Depth~poly(all.filt$MA_Freq,2))) #r2 = 0.03
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_point()
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_smooth(method = lm)
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_smooth(formula = y ~ poly(x,2))
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_smooth()
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_point() +
geom_smooth(method = lm, colour = "grey50") +
geom_smooth(colour = "orange") +
geom_smooth(formula = y ~ poly(x,2), colour = "blue")
?axis
boxplot(spp.pairs$Percent.Ident, clade.pairs$Percent.Ident, nonclade.pairs$Percent.Ident, ylab = "Percent of Idenitcal Sequences",
yaxt = "n", xaxt = "n", ylim = c(0, 0.51))
axis(2, at = seq(0,0.5, by = 0.1),labels = c("0%","10%","20%","30%","40%","50%"))
axis(1, at = c(1,2,3),labels = c("Same Species","Same Clade","Different Clades"))
axis(1, at = c(1,2,3), labels = c("N = 33", "N = 162", "N = 4268"), line = 2)
boxplot(spp.pairs$Percent.Ident, clade.pairs$Percent.Ident, nonclade.pairs$Percent.Ident, ylab = "Percent of Idenitcal Sequences",
yaxt = "n", xaxt = "n", ylim = c(0, 0.51))
axis(2, at = seq(0,0.5, by = 0.1),labels = c("0%","10%","20%","30%","40%","50%"))
axis(1, at = c(1,2,3),labels = c("Same Species","Same Clade","Different Clades"))
axis(1, at = c(1,2,3), labels = c("N = 33", "N = 162", "N = 4268"), line = 2, tick = FALSE)
boxplot(spp.pairs$Percent.Ident, clade.pairs$Percent.Ident, nonclade.pairs$Percent.Ident, ylab = "Percent of Idenitcal Sequences",
yaxt = "n", xaxt = "n", ylim = c(0, 0.51))
axis(2, at = seq(0,0.5, by = 0.1),labels = c("0%","10%","20%","30%","40%","50%"))
axis(1, at = c(1,2,3),labels = c("Same Species","Same Clade","Different Clades"))
axis(1, at = c(1,2,3), labels = c("N = 33", "N = 162", "N = 4268"), line = 1, tick = FALSE)
t.test(spp.pairs$Percent.Ident, clade.pairs$Percent.Ident)
var.test(spp.pairs$Percent.Ident, clade.pairs$Percent.Ident)
var.test(clade.pairs$Percent.Ident, spp.pairs$Percent.Ident) #var equal
var.test(spp.pairs$Percent.Ident, clade.pairs$Percent.Ident)
var.test(clade.pairs$Percent.Ident, spp.pairs$Percent.Ident) #var equal
var.test(spp.pairs$Percent.Ident, clade.pairs$Percent.Ident) #var equal
var.test(spp.pairs$Percent.Ident, nonclade.pairs$Percent.Ident)
var.test(clade.pairs$Percent.Ident, nonclade.pairs$Percent.Ident)
t.test(spp.pairs$Percent.Ident, clade.pairs$Percent.Ident, var.equal = TRUE)
t.test(spp.pairs$Percent.Ident, nonclade.pairs$Percent.Ident, var.equal = FALSE) #var diff
t.test(clade.pairs$Percent.Ident, nonclade.pairs$Percent.Ident, var.equal = FALSE) #var diff
boxplot(spp.pairs$Percent.Ident, clade.pairs$Percent.Ident, nonclade.pairs$Percent.Ident, ylab = "Percent of Idenitcal Sequences",
yaxt = "n", xaxt = "n", ylim = c(0, 0.51))
axis(2, at = seq(0,0.5, by = 0.1),labels = c("0%","10%","20%","30%","40%","50%"))
axis(1, at = c(1,2,3),labels = c("Same Species","Same Clade","Different Clades"))
axis(1, at = c(1,2,3), labels = c("N = 33", "N = 162", "N = 4268"), line = 1 , tick = FALSE)
text(x = 3, y = 0.5, "*")
boxplot(spp.pairs$Percent.Ident, clade.pairs$Percent.Ident, nonclade.pairs$Percent.Ident, ylab = "Percent of Idenitcal Sequences",
yaxt = "n", xaxt = "n", ylim = c(0, 0.51))
axis(2, at = seq(0,0.5, by = 0.1),labels = c("0%","10%","20%","30%","40%","50%"))
axis(1, at = c(1,2,3),labels = c("Same Species","Same Clade","Different Clades"))
axis(1, at = c(1,2,3), labels = c("N = 33", "N = 162", "N = 4268"), line = 1 , tick = FALSE)
text(x = 3, y = 0.5, "*", cex = 4)
?tiff
tiff(filename = "../../../../Desktop/Percent_ident_boxplot.tiff", width = 7, height = 5, units = "in")
tiff(filename = "../../../../Desktop/Percent_ident_boxplot.tiff", width = 7, height = 5, units = "in", res = 300)
boxplot(spp.pairs$Percent.Ident, clade.pairs$Percent.Ident, nonclade.pairs$Percent.Ident, ylab = "Percent of Idenitcal Sequences",
yaxt = "n", xaxt = "n", ylim = c(0, 0.51))
axis(2, at = seq(0,0.5, by = 0.1),labels = c("0%","10%","20%","30%","40%","50%"))
axis(1, at = c(1,2,3),labels = c("Same Species","Same Clade","Different Clades"))
axis(1, at = c(1,2,3), labels = c("N = 33", "N = 162", "N = 4268"), line = 1 , tick = FALSE)
text(x = 3, y = 0.5, "*", cex = 4)
dev.off()
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_point(colour = "grey20") + theme_classic() +
geom_smooth(formula = y ~ poly(x,2), colour = "black")
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_point(colour = "grey80") + theme_classic() +
geom_smooth(formula = y ~ poly(x,2), colour = "black")
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_point(colour = "grey80") + theme_classic() +
geom_smooth(formula = y ~ poly(x,2), colour = "black") +
title(x = "Occurence Rate of Minor Allele", y = "Read Depth")
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_point(colour = "grey80") + theme_classic() +
geom_smooth(formula = y ~ poly(x,2), colour = "black") +
title(x = "Occurence Rate of Minor Allele", y = "Read Depth") +
theme(axis.title.x = element_text(size=14, face="bold"),axis.title.y = element_text(size=14, face="bold"))
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_point(colour = "grey80") + theme_classic() +
geom_smooth(formula = y ~ poly(x,2), colour = "black") +
labs(x = "Occurence Rate of Minor Allele", y = "Read Depth") +
theme(axis.title.x = element_text(size=14, face="bold"),axis.title.y = element_text(size=14, face="bold"))
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_point(colour = "grey80") + theme_classic() +
geom_smooth(formula = y ~ poly(x,2), colour = "black") +
labs(x = "Occurence Rate of Minor Allele", y = "Read Depth") +
theme(axis.title.x = element_text(size=14, face="bold"),axis.title.y = element_text(size=14, face="bold"),
axis.text=element_text(size=14, colour = "black"))
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_point(colour = "grey80") + theme_classic() +
geom_smooth(formula = y ~ poly(x,2), colour = "black") +
labs(x = "Occurence Rate of Minor Allele", y = "Read Depth") +
theme(axis.title.x = element_text(size=14, face="bold"),axis.title.y = element_text(size=14, face="bold"),
axis.text=element_text(size=12, colour = "black"))
tiff(filename = "../../../../Desktop/Depth_MAfreq.tiff", width = 7, height = 5, units = "in", res = 300)
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_point(colour = "grey80") + theme_classic() +
geom_smooth(formula = y ~ poly(x,2), colour = "black") +
labs(x = "Occurence Rate of Minor Allele", y = "Read Depth") +
theme(axis.title.x = element_text(size=14, face="bold"),axis.title.y = element_text(size=14, face="bold"),
axis.text=element_text(size=12, colour = "black"))
dev.off()
#tiff(filename = "../../../../Desktop/Depth_MAfreq.tiff", width = 7, height = 5, units = "in", res = 300)
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) + geom_point(colour = "grey80") + theme_classic() +
geom_smooth(formula = y ~ poly(x,2), colour = "black") +
labs(x = "Occurence Rate of Minor Allele", y = "Read Depth") +
theme(axis.title.x = element_text(size=14, face="bold"),axis.title.y = element_text(size=14, face="bold"),
axis.text=element_text(size=12, colour = "black")) +
geom_text(x=0.45, y=340, label="r2 = 0.03")
#dev.off()
#tiff(filename = "../../../../Desktop/Depth_MAfreq.tiff", width = 7, height = 5, units = "in", res = 300)
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) +
#geom_point(colour = "grey80") +
theme_classic() +
geom_smooth(formula = y ~ poly(x,2), colour = "black") +
labs(x = "Occurence Rate of Minor Allele", y = "Read Depth") +
theme(axis.title.x = element_text(size=14, face="bold"),axis.title.y = element_text(size=14, face="bold"),
axis.text=element_text(size=12, colour = "black")) +
geom_text(x=0.45, y=320, label="r2 = 0.03")
#dev.off()
dev.off()
#tiff(filename = "../../../../Desktop/Depth_MAfreq.tiff", width = 7, height = 5, units = "in", res = 300)
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) +
geom_point(colour = "grey80") +
theme_classic() +
geom_smooth(formula = y ~ poly(x,2), colour = "black") +
labs(x = "Occurence Rate of Minor Allele", y = "Read Depth") +
theme(axis.title.x = element_text(size=14, face="bold"),axis.title.y = element_text(size=14, face="bold"),
axis.text=element_text(size=12, colour = "black")) +
geom_text(x=0.45, y=320, label="r2 = 0.03")
#dev.off()
#tiff(filename = "../../../../Desktop/Depth_MAfreq.tiff", width = 7, height = 5, units = "in", res = 300)
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) +
geom_point(colour = "grey80") +
theme_classic() +
geom_smooth(formula = y ~ poly(x,2), colour = "black") +
labs(x = "Occurence Rate of Minor Allele", y = "Read Depth") +
theme(axis.title.x = element_text(size=14, face="bold"),axis.title.y = element_text(size=14, face="bold"),
axis.text=element_text(size=12, colour = "black")) +
geom_text(x=0.48, y=320, label=expression(r^2=0.03))
expression(r^2"=0.03")
#tiff(filename = "../../../../Desktop/Depth_MAfreq.tiff", width = 7, height = 5, units = "in", res = 300)
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) +
geom_point(colour = "grey80") +
theme_classic() +
geom_smooth(formula = y ~ poly(x,2), colour = "black") +
labs(x = "Occurence Rate of Minor Allele", y = "Read Depth") +
theme(axis.title.x = element_text(size=14, face="bold"),axis.title.y = element_text(size=14, face="bold"),
axis.text=element_text(size=12, colour = "black")) +
geom_text(x=0.48, y=320, label=expression(r^2==0.03))
expression(r^2 == 0.03)
print(expression(r^2 == 0.03))
expression(r^2)
#tiff(filename = "../../../../Desktop/Depth_MAfreq.tiff", width = 7, height = 5, units = "in", res = 300)
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) +
geom_point(colour = "grey80") +
theme_classic() +
geom_smooth(formula = y ~ poly(x,2), colour = "black") +
labs(x = "Occurence Rate of Minor Allele", y = "Read Depth") +
theme(axis.title.x = element_text(size=14, face="bold"),axis.title.y = element_text(size=14, face="bold"),
axis.text=element_text(size=12, colour = "black")) +
geom_text(x=0.48, y=320, label=expression(r^2 "=" 0.03))
#tiff(filename = "../../../../Desktop/Depth_MAfreq.tiff", width = 7, height = 5, units = "in", res = 300)
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) +
geom_point(colour = "grey80") +
theme_classic() +
geom_smooth(formula = y ~ poly(x,2), colour = "black") +
labs(x = "Occurence Rate of Minor Allele", y = "Read Depth") +
theme(axis.title.x = element_text(size=14, face="bold"),axis.title.y = element_text(size=14, face="bold"),
axis.text=element_text(size=12, colour = "black")) +
geom_text(x=0.48, y=320, label=expression(r^2 == 0.03))
#dev.off()
tiff(filename = "../../../../Desktop/Depth_MAfreq.tiff", width = 7, height = 5, units = "in", res = 300)
ggplot(all.filt, aes(x=MA_Freq, y=Depth)) +
geom_point(colour = "grey80") +
theme_classic() +
geom_smooth(formula = y ~ poly(x,2), colour = "black") +
labs(x = "Occurence Rate of Minor Allele", y = "Read Depth") +
theme(axis.title.x = element_text(size=14, face="bold"),axis.title.y = element_text(size=14, face="bold"),
axis.text=element_text(size=12, colour = "black")) +
geom_text(x=0.48, y=320, label=expression(r^2 == 0.03))
dev.off()
filenames <- list.files(path = "../4_Run_2/7_nf_aligned_orn/") #make list of filenames of gene alignment fastas
gene_data <- matrix(data = NA, nrow = 0, ncol = 3) #second matrix with gene info
colnames(gene_data) <- c("gene_name", "avg_pdist", "locus_length") #naming columns for gene info matrix
for (i in 1:length(filenames)){ #loop over filename list to do action for each gene in folder
gene_name <- filenames[i] #get gene for each run
gene <- read.FASTA(paste("../4_Run_2/7_nf_aligned_orn/",gene_name, sep = "")) #read in gene alignment
gene.dist <- dist.dna(gene)#get distance matrix as data frame for names
avg_pdist <-mean(gene.dist)
locus_length <- length(gene[[1]])
rowdata <- c(gene_name, avg_pdist, locus_length)
gene_data <- rbind(gene_data,rowdata)
}
gene_ps<- as.data.frame(gene_data)
View(gene_ps)
write.csv(gene_ps, "P_distances_bygene.csv", row.names = FALSE)
p.dists <- read.csv("P_distances_bygene.csv", header = TRUE)
View(p.dists)
hist(p.dists$avg_pdist)
max(p.dists$avg_pdist)
hist(p.dists$avg_pdist, main = "", xlab = "Average p-distance for each of 2917 exons", xlim = c(0,0.2), ylim = c(0,300))
hist(p.dists$avg_pdist, main = "", xlab = "Average p-distance for each of 2917 exons", xlim = c(0,0.2), ylim = c(0,500))
hist(p.dists$avg_pdist, main = "", xlab = "Average p-distance for each of 2917 exons", xlim = c(0,0.2), ylim = c(0,1000))
hist(p.dists$avg_pdist, main = "", xlab = "Average p-distance for each of 2917 exons", xlim = c(0,0.2), ylim = c(0,900))
tiff(filename = "../../../../Desktop/pdist_hist.tiff", width = 7, height = 5, units = "in", res = 300)
hist(p.dists$avg_pdist, main = "", xlab = "Average p-distance for each of 2917 exons", xlim = c(0,0.2), ylim = c(0,900))
dev.off()
hist(all.filt$MA_Freq, main="", xlab = "Rate of Occurence of Minor Allele for 61204 SNP Loci")
hist(all.filt$MA_Freq, main="", xlab = "Rate of Occurence of Minor Allele")
axis(1, at = 0.2, labels = c("N = 61204 filtered SNPs"), line = 1 , tick = FALSE)
hist(all.filt$MA_Freq, main="", xlab = "Rate of Occurence of Minor Allele")
axis(1, at = 0.25, labels = c("N = 61204 filtered SNPs"), line = 3 , tick = FALSE)
hist(all.filt$MA_Freq, main="", xlab = "")
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 filtered SNPs"), line = 2, tick = FALSE)
hist(all.filt$MA_Freq, main="", xlab = "")
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 filtered SNPs"), line = 2.5, tick = FALSE)
hist(all.depth$Depth, main = "", xlab = "", xlim = c(0,325), ylim = c(0,50000))
abline(v=20, col = "red", lwd = 2)
axis(1, at = 0.25, labels = c("Read Depth per Locus"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 105844 filtered SNP Loci"), line = 2.5, tick = FALSE)
hist(all.depth$Depth, main = "", xlab = "", xlim = c(0,325), ylim = c(0,50000))
abline(v=20, col = "red", lwd = 2)
axis(1, at = 150, labels = c("Read Depth per Locus"), line = 1.5, tick = FALSE)
axis(1, at = 150, labels = c("N = 105844 filtered SNP Loci"), line = 2.5, tick = FALSE)
hist(all.depth$Depth, main = "", xlab = "", xlim = c(0,325), ylim = c(0,50000))
abline(v=20, col = "red", lwd = 2)
axis(1, at = 150, labels = c("Read Depth per Locus"), line = 1.5, tick = FALSE)
axis(1, at = 150, labels = c("N = 105,844 filtered SNP Loci"), line = 2.5, tick = FALSE)
tiff(filename = "../../../../Desktop/Read_Depth_hist.tiff", width = 7, height = 5, units = "in", res = 300)
hist(all.depth$Depth, main = "", xlab = "", xlim = c(0,325), ylim = c(0,50000))
abline(v=20, col = "red", lwd = 2)
axis(1, at = 150, labels = c("Read Depth per Locus"), line = 1.5, tick = FALSE)
axis(1, at = 150, labels = c("N = 105,844 filtered SNP Loci"), line = 2.5, tick = FALSE)
dev.off()
tiff(filename = "../../../../Desktop/MA_freq_hist.tiff", width = 7, height = 5, units = "in", res = 300)
hist(all.filt$MA_Freq, main="", xlab = "")
axis(1, at = 0.25, labels = c("Rate of Occurence of Minor Allele"), line = 1.5, tick = FALSE)
axis(1, at = 0.25, labels = c("N = 61204 filtered SNPs"), line = 2.5, tick = FALSE)
dev.off()
p.dists <- read.csv("P_distances_bygene.csv", header = TRUE)
max(p.dists$avg_pdist)
mean(p.dists$avg_pdist)
sd(p.dists$avg_pdist)
p.dists <- read.csv("P_distances_bygene.csv", header = TRUE)
max(p.dists$avg_pdist)
mean(p.dists$avg_pdist)
sd(p.dists$avg_pdist)
contam <- read.delim("../jg-exon-capture/6_Detect_Contamination/15_Detect_Contam/contamination_stat3.txt")
per.con <- contam$Percentage.of.contaminated.pair...
per.con <- contam$Average.of.Percentage.of.contaminated.pair...
contam <- read.delim("../jg-exon-capture/6_Detect_Contamination/15_Detect_Contam/contamination_stat3.txt")
per.con <- contam$Average.of.Percentage.of.contaminated.pair...
contam <- read.delim("../jg-exon-capture/6_Detect_Contamination/15_Detect_Contam/contamination_stat3_full.txt")
per.con <- contam$Percentage.of.contaminated.pair...
hist(per.con, xlim = c(0,30), breaks = 30)
length(per.con)
per.con <- sort(per.con)
sum(per.con>=15)/length(per.con)
0.95*length(per.con)
per.con[4235]
library(tidyverse)
library(ape)
library(rstatix)
library(phytools)
library(mgcv)
identical_sequences <- read.csv("Identical_Sequences_files/Identical_Sequences.csv", row.names = 1)
total_sequences <- read.csv("Identical_Sequences_files/Total_Sequences.csv", row.names = 1)
percent_identical <- identical_sequences/total_sequences
all.same.clade <- read.csv("Identical_Sequences_files/same_clade_all.csv", header = FALSE)
colnames(all.same.clade) <- c("COLUMN","ROW")
same.clade.pairs <- read.csv("Identical_Sequences_files/same_clade_pairs.csv", header = FALSE)
colnames(same.clade.pairs) <- c("COLUMN","ROW")
same.spp.pairs <- read.csv("Identical_Sequences_files/same_spp_pairs.csv", header = FALSE)
colnames(same.spp.pairs) <- c("COLUMN","ROW")
nonclade.pairs <- anti_join(all.pairs, all.same.clade, by = c("COLUMN","ROW"))
all.lip.samples <- read.csv("Identical_Sequences_files/all_lip_samples.csv", header = FALSE)
all.lip.samples <- as.vector(all.lip.samples$V1)
all.pairs <- as.data.frame(matrix(nrow = 0, ncol = 3, data = NA))
colnames(all.pairs) <- c("COLUMN","ROW","Percent.Ident")
for(i in 1:length(all.lip.samples)){
column <- all.lip.samples[i]
for(j in 1:(length(all.lip.samples)-i)){
row.start <- i+1
row.spp <- all.lip.samples[row.start:length(all.lip.samples)]
row <- row.spp[j]
percent.ident <- percent_identical[row,column]
rowdat <- c(column, row, percent.ident)
all.pairs <- rbind(all.pairs, rowdat)
}
}
colnames(all.pairs) <- c("COLUMN","ROW","Percent.Ident")
all.pairs <- all.pairs[1:4465,]
all.pairs$Percent.Ident <- as.numeric(all.pairs$Percent.Ident)
all.same.clade <- read.csv("Identical_Sequences_files/same_clade_all.csv", header = FALSE)
colnames(all.same.clade) <- c("COLUMN","ROW")
same.clade.pairs <- read.csv("Identical_Sequences_files/same_clade_pairs.csv", header = FALSE)
colnames(same.clade.pairs) <- c("COLUMN","ROW")
same.spp.pairs <- read.csv("Identical_Sequences_files/same_spp_pairs.csv", header = FALSE)
colnames(same.spp.pairs) <- c("COLUMN","ROW")
nonclade.pairs <- anti_join(all.pairs, all.same.clade, by = c("COLUMN","ROW"))
clade.pairs <- inner_join(all.pairs, same.clade.pairs,  by = c("COLUMN","ROW"))
spp.pairs <- inner_join(all.pairs, same.spp.pairs,  by = c("COLUMN","ROW"))
summary(spp.pairs$Percent.Ident)
length(spp.pairs$Percent.Ident)
sd(spp.pairs$Percent.Ident)
summary(clade.pairs$Percent.Ident) #min = 4.6 %; Mean = 25.2% +/- 10.7%; max = 47.9%; N = 35;
length(clade.pairs$Percent.Ident)
sd(clade.pairs$Percent.Ident)
summary(nonclade.pairs$Percent.Ident) #min = 4.6 %; Mean = 25.2% +/- 10.7%; max = 47.9%; N = 35;
length(nonclade.pairs$Percent.Ident)
sd(nonclade.pairs$Percent.Ident)
t.test(spp.pairs$Percent.Ident, nonclade.pairs$Percent.Ident, var.equal = FALSE, alternative = "greater") #var diff
t.test(spp.pairs$Percent.Ident, nonclade.pairs$Percent.Ident, var.equal = FALSE, alternative = "less") #var diff
t.test(spp.pairs$Percent.Ident, clade.pairs$Percent.Ident, var.equal = TRUE)
t.test(spp.pairs$Percent.Ident, nonclade.pairs$Percent.Ident, var.equal = FALSE, alternative = "greater") #var diff
t.test(clade.pairs$Percent.Ident, nonclade.pairs$Percent.Ident, var.equal = FALSE, alternative = "greater") #var diff
all.depth <- read.csv("../12_bowtie/All_Dp_AD_combined.csv")
all.filt <- read.csv("../12_bowtie/All_Dp_AD_filtered.csv")
mean(all.filt$MA_Freq)
sd(all.filt$MA_Freq)
mean(all.filt$MA_Freq)
sd(all.filt$MA_Freq)
max(all.depth$Depth)
length(which(all.depth$Depth > 300))
length(which(all.depth$Depth > 200))
16819/length(all.filt$Depth)
length(which(all.depth$Depth > 250))/length(all.filt$Depth)
length(which(all.depth$Depth > 250))/length(all.depth$Depth)
length(which(all.depth$Depth > 200))/length(all.depth$Depth)
sd(all.filt$Depth)
500*4434
3e8
300/2
500*4434 # roughly 2 million reads per individual (reasonable goal)
11e6/4434
300/11
400/11
300/25
400/25
300/11
11*52
library(tidyverse)
library(ape)
library(rstatix)
library(phytools)
library(mgcv)
run2 <- read.newick(file = "../4_Run_2/9_RAxML_orn_rm/RAxML_bootstrap.9_orn")
run2.consensus <- consensus(run2, p = 0.5, check.labels = TRUE, rooted = FALSE)
plotTree(run2.consensus)
run2 <- read.newick(file = "../4_Run_2/9_RAxML_orn_rm_bl/RAxML_bootstrap.9_orn_bl")
library(tidyverse)
library(ape)
library(rstatix)
library(phytools)
library(mgcv)
run2 <- read.newick(file = "../4_Run_2/9_RAxML_orn_rm_bl/RAxML_bootstrap.9_orn_bl")
run2 <- read.tree(file = "../4_Run_2/9_RAxML_orn_rm_bl/RAxML_bootstrap.9_orn_bl")
run2.consensus <- consensus(run2, p = 0.5, check.labels = TRUE, rooted = FALSE)
plotTree(run2.consensus)
run2 <- read.tree(file = "../4_Run_2/9_RAxML_orn_rm_bl/RAxML_bootstrap.9_orn_bl")
run2.consensus <- consensus(run2, p = 0.5, check.labels = TRUE, rooted = FALSE)
plotTree(run2.consensus)
run2.consensus.bl <- consensus.edges(run2)
plotTree(run2.consensus.bl)
run6 <- read.tree(file = "../9_Run_6/28_RAxML_r6_bl/RAxML_bootstrap.28_r6_bl")
library(tidyverse)
library(ape)
library(rstatix)
library(phytools)
library(mgcv)
run6 <- read.tree(file = "../9_Run_6/28_RAxML_r6_bl/RAxML_bootstrap.28_r6_bl")
run6.consensus <- consensus(run6, p = 0.5, check.labels = TRUE, rooted = FALSE)
run6.consensus.bl <- consensus.edges(run6)
plotTree(run6.consensus)
plotTree(run6.consensus.bl)
rungene <- read.tree(file = "../10_Gene_Trees/32_RAxML_full_bl/RAxML_bootstrap.32_full_bl")
rungene.consensus <- consensus(rungene, p = 0.5, check.labels = TRUE, rooted = FALSE)
rungene.consensus.bl <- consensus.edges(rungene)
plotTree(rungene.consensus)
plotTree(rungene.consensus.bl)
run2 <- read.tree(file = "../4_Run_2/9_RAxML_orn_rm_bl/RAxML_bootstrap.9_orn_bl")
run2.consensus <- consensus(run2, p = 0.5, check.labels = TRUE, rooted = FALSE)
run2.consensus.bl <- consensus.edges(run2)
write.tree(run2.consensus.bl, file = "TreeFigures/Run2_consensus.tree", digits = 20)
write.tree(run6.consensus.bl, file = "TreeFigures/Run6_consensus.tree", digits = 20)
write.tree(rungene.consensus.bl, file = "TreeFigures/Rungene_consensus.tree", digits = 20)
