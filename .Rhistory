install.packages("ape")
#rmORENILO
library(ape)
concat <- read.dna("../jg-exon-capture/12_concatinate_v2/12_concat_nf_v2.fas",format = "fasta")
unique(concat)
unique(as.vector(concat[1,]))
head(concat)
library(help = ape)
?apetools
?del.gaps
del.colgapsonly(concat, threshold = 0.5, freq.only = TRUE)
image(concat, what = "-")
# Ape delete.gaps test
library(ape)
full_concat <- read.dna("../jg-exon-capture/12_concatinate_v2/12_concat_nf_v2.fas",format = "fasta")
partial_concat <- subset(full_concat, subset = 1:3)
full_concat[1,]
full_concat[,1]
partial_concat <- full_concat[1:3,]
partial_concat <- full_concat[1:3,1:10000]
head(partial_concat)
partial_concat <- full_concat[1:3,5000:10000]
image(partial_concat)
partial_concat <- full_concat[1:5,5000:10000]
image(partial_concat)
partial_concat <- full_concat[6:10,5000:10000]
image(partial_concat)
partial_concat <- full_concat[1:10,5000:10000]
image(partial_concat)
partial_concat <- full_concat[1:20,5000:10000]
image(partial_concat)
partial_concat <- full_concat[1:20,6000:11000]
image(partial_concat)
partial_concat <- full_concat[1:20,11000:16000]
image(partial_concat)
partial_concat <- full_concat[1:20,10000:20000]
image(partial_concat)
partial_concat <- full_concat[1:19,20000:30000]
image(partial_concat)
partial_concat <- full_concat[1:19,30000:40000]
image(partial_concat)
partial_concat <- full_concat[1:19,40000:50000]
image(partial_concat)
image(partial_concat, what = "-", col = "black", bg = "pink")
partial_concat <- full_concat[1:19,50000:60000]
image(partial_concat, what = "-", col = "black", bg = "pink")
partial_concat <- full_concat[1:19,60000:70000]
image(partial_concat, what = "-", col = "black", bg = "pink")
partial_concat <- full_concat[1:19,70000:80000]
image(partial_concat, what = "-", col = "black", bg = "pink")
partial_concat <- full_concat[1:19,80000:90000]
image(partial_concat, what = "-", col = "black", bg = "pink")
head(full_concat)
partial_concat <- full_concat[1:19,90000:100000]
image(partial_concat, what = "-", col = "black", bg = "pink")
partial_concat <- full_concat[1:19,100000:110000]
image(partial_concat, what = "-", col = "black", bg = "pink")
partial_concat <- full_concat[1:19,110000:130000]
image(partial_concat, what = "-", col = "black", bg = "pink")
partial_concat <- full_concat[1:19,50000:80000]
image(partial_concat, what = "-", col = "black", bg = "pink")
partial_concat <- full_concat[1:19,50000:60000]
image(partial_concat, what = "-", col = "black", bg = "pink")
partial_delete <- del.colgapsonly(partial_concat, freq.only = TRUE)
partial_delete
19*0.5
library(tidyverse)
partial_delete[partial_delete>10]
partial_delete[partial_delete>9]
unique(partial_delete)
partial_concat_count<- del.colgapsonly(partial_concat, freq.only = TRUE)
sort(unique(partial_concat_count))
table(partial_concat_count)
partial_delete <- del.colgapsonly(partial_concat, threshold = 0.5)
image(partial_delete what = "-", col = "black", bg = "pink")
image(partial_delete, what = "-", col = "black", bg = "pink")
partial_delete_count<- del.colgapsonly(partial_delete, freq.only = TRUE)
table(partial_delete_count)
partial_concat <- full_concat[1:20,50000:60000]
partial_concat_count<- del.colgapsonly(partial_concat, freq.only = TRUE)
sort(unique(partial_concat_count))
table(partial_concat_count)
19*0.75
20*.75
20*.8
partial_delete <- del.colgapsonly(partial_concat, threshold = 0.8)
partial_delete_count<- del.colgapsonly(partial_delete, freq.only = TRUE)
table(partial_delete_count)
18/20
partial_delete <- del.colgapsonly(partial_concat, threshold = 0.9)
image(partial_delete, what = "-", col = "black", bg = "pink")
partial_delete_count<- del.colgapsonly(partial_delete, freq.only = TRUE)
table(partial_delete_count)
partial_delete <- del.colgapsonly(partial_concat, threshold = 0.5)
partial_delete_count<- del.colgapsonly(partial_delete, freq.only = TRUE)
table(partial_delete_count)
#97 seq of 433,323 bases
full_concat_count <- del.colgapsonly(full_concat, freq.only = TRUE)
table(full_concat_count)
as.matrix(table(full_concat_count))
97*0.5
full_concat_delete <- del.colgapsonly(full_concat, threshold = 0.5)
full_delete_count <- del.colgapsonly(full_concat_delete, freq.only = TRUE)
as.matrix(table(full_delete_count))
head(full_concat_delete)
#97 seq of 430,998 baeses
write.FASTA(full_concat_delete, "../jg-exon-capture/12_concatinate_v2/12_concat_filtered.fas")
